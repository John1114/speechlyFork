!function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function a(){return Object.create(null)}function i(e){e.forEach(n)}function r(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t}const s="undefined"!=typeof window;let l=s?()=>window.performance.now():()=>Date.now(),c=s?e=>requestAnimationFrame(e):e;const u=new Set;function d(e){u.forEach((t=>{t.c(e)||(u.delete(t),t.f())})),0!==u.size&&c(d)}function h(e){let t;return 0===u.size&&c(d),{promise:new Promise((n=>{u.add(t={c:e,f:n})})),abort(){u.delete(t)}}}let m=!1;const f=new Set;function p(e,t){m&&f.delete(t),t.parentNode!==e&&e.appendChild(t)}function v(e,t,n){m&&f.delete(t),(t.parentNode!==e||n&&t.nextSibling!==n)&&e.insertBefore(t,n||null)}function g(e){m?f.add(e):e.parentNode&&e.parentNode.removeChild(e)}function y(e){return document.createElement(e)}function S(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function b(e){return document.createTextNode(e)}function w(){return b(" ")}function C(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function N(e,t,n){t in e?e[t]="boolean"==typeof e[t]&&""===n||n:C(e,t,n)}function k(e,t,n,a){e.style.setProperty(t,n,a?"important":"")}function T(e,t,n){e.classList[n?"add":"remove"](t)}function A(e){const t={};for(const n of e)t[n.name]=n.value;return t}const E=new Set;let _,I=0;function R(e,t,n,a,i,r,o,s=0){const l=16.666/a;let c="{\n";for(let e=0;e<=1;e+=l){const a=t+(n-t)*r(e);c+=100*e+`%{${o(a,1-a)}}\n`}const u=c+`100% {${o(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${s}`,h=e.ownerDocument;E.add(h);const m=h.__svelte_stylesheet||(h.__svelte_stylesheet=h.head.appendChild(y("style")).sheet),f=h.__svelte_rules||(h.__svelte_rules={});f[d]||(f[d]=!0,m.insertRule(`@keyframes ${d} ${u}`,m.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${d} ${a}ms linear ${i}ms 1 both`,I+=1,d}function x(e,t){const n=(e.style.animation||"").split(", "),a=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),i=n.length-a.length;i&&(e.style.animation=a.join(", "),I-=i,I||c((()=>{I||(E.forEach((e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}})),E.clear())})))}function M(e){_=e}function O(){if(!_)throw new Error("Function called outside component initialization");return _}function P(e){O().$$.on_mount.push(e)}const L=[],B=[],F=[],D=[],z=Promise.resolve();let $=!1;function j(e){F.push(e)}let W=!1;const U=new Set;function G(){if(!W){W=!0;do{for(let e=0;e<L.length;e+=1){const t=L[e];M(t),K(t.$$)}for(M(null),L.length=0;B.length;)B.pop()();for(let e=0;e<F.length;e+=1){const t=F[e];U.has(t)||(U.add(t),t())}F.length=0}while(L.length);for(;D.length;)D.pop()();$=!1,W=!1,U.clear()}}function K(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(j)}}let V;function H(){return V||(V=Promise.resolve(),V.then((()=>{V=null}))),V}function J(e,t,n){e.dispatchEvent(function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(`${t?"intro":"outro"}${n}`))}const Z=new Set;let X;function q(){X={r:0,c:[],p:X}}function Y(){X.r||i(X.c),X=X.p}function Q(e,t){e&&e.i&&(Z.delete(e),e.i(t))}function ee(e,t,n,a){if(e&&e.o){if(Z.has(e))return;Z.add(e),X.c.push((()=>{Z.delete(e),a&&(n&&e.d(1),a())})),e.o(t)}}const te={duration:0};function ne(n,a,i){let o,s,c=a(n,i),u=!1,d=0;function m(){o&&x(n,o)}function f(){const{delay:a=0,duration:i=300,easing:r=t,tick:f=e,css:p}=c||te;p&&(o=R(n,0,1,i,a,r,p,d++)),f(0,1);const v=l()+a,g=v+i;s&&s.abort(),u=!0,j((()=>J(n,!0,"start"))),s=h((e=>{if(u){if(e>=g)return f(1,0),J(n,!0,"end"),m(),u=!1;if(e>=v){const t=r((e-v)/i);f(t,1-t)}}return u}))}let p=!1;return{start(){p||(x(n),r(c)?(c=c(),H().then(f)):f())},invalidate(){p=!1},end(){u&&(m(),u=!1)}}}function ae(n,a,o){let s,c=a(n,o),u=!0;const d=X;function m(){const{delay:a=0,duration:r=300,easing:o=t,tick:m=e,css:f}=c||te;f&&(s=R(n,1,0,r,a,o,f));const p=l()+a,v=p+r;j((()=>J(n,!1,"start"))),h((e=>{if(u){if(e>=v)return m(0,1),J(n,!1,"end"),--d.r||i(d.c),!1;if(e>=p){const t=o((e-p)/r);m(1-t,t)}}return u}))}return d.r+=1,r(c)?H().then((()=>{c=c(),m()})):m(),{end(e){e&&c.tick&&c.tick(1,0),u&&(s&&x(n,s),u=!1)}}}const ie="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function re(e,t){-1===e.$$.dirty[0]&&(L.push(e),$||($=!0,z.then(G)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function oe(t,o,s,l,c,u,d=[-1]){const h=_;M(t);const p=t.$$={fragment:null,ctx:null,props:u,update:e,not_equal:c,bound:a(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(h?h.$$.context:o.context||[]),callbacks:a(),dirty:d,skip_bound:!1};let v=!1;if(p.ctx=s?s(t,o.props||{},((e,n,...a)=>{const i=a.length?a[0]:n;return p.ctx&&c(p.ctx[e],p.ctx[e]=i)&&(!p.skip_bound&&p.bound[e]&&p.bound[e](i),v&&re(t,e)),n})):[],p.update(),v=!0,i(p.before_update),p.fragment=!!l&&l(p.ctx),o.target){if(o.hydrate){m=!0;const e=function(e){return Array.from(e.childNodes)}(o.target);p.fragment&&p.fragment.l(e),e.forEach(g)}else p.fragment&&p.fragment.c();o.intro&&Q(t.$$.fragment),function(e,t,a,o){const{fragment:s,on_mount:l,on_destroy:c,after_update:u}=e.$$;s&&s.m(t,a),o||j((()=>{const t=l.map(n).filter(r);c?c.push(...t):i(t),e.$$.on_mount=[]})),u.forEach(j)}(t,o.target,o.anchor,o.customElement),function(){m=!1;for(const e of f)e.parentNode.removeChild(e);f.clear()}(),G()}M(h)}let se;"function"==typeof HTMLElement&&(se=class extends HTMLElement{constructor(){super(),this.attachShadow({mode:"open"})}connectedCallback(){const{on_mount:e}=this.$$;this.$$.on_disconnect=e.map(n).filter(r);for(const e in this.$$.slotted)this.appendChild(this.$$.slotted[e])}attributeChangedCallback(e,t,n){this[e]=n}disconnectedCallback(){i(this.$$.on_disconnect)}$destroy(){!function(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}});var le="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function ce(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})})),t}function ue(e){var t={exports:{}};return e(t,t.exports),t.exports}var de=ue((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.ClientState||(t.ClientState={}))[n.Failed=0]="Failed",n[n.NoBrowserSupport=1]="NoBrowserSupport",n[n.NoAudioConsent=2]="NoAudioConsent",n[n.Disconnected=3]="Disconnected",n[n.Disconnecting=4]="Disconnecting",n[n.Connecting=5]="Connecting",n[n.Connected=6]="Connected",n[n.Starting=7]="Starting",n[n.Stopping=8]="Stopping",n[n.Recording=9]="Recording"}));var he=function(e){var t;return null!==(t=fe.get(e))&&void 0!==t?t:me};const me="Unknown",fe=new Map([[de.ClientState.Failed,"Failed"],[de.ClientState.NoBrowserSupport,"NoBrowserSupport"],[de.ClientState.NoAudioConsent,"NoAudioConsent"],[de.ClientState.Disconnecting,"Disconnecting"],[de.ClientState.Disconnected,"Disconnected"],[de.ClientState.Connecting,"Connecting"],[de.ClientState.Connected,"Connected"],[de.ClientState.Starting,"Starting"],[de.ClientState.Stopping,"Stopping"],[de.ClientState.Recording,"Recording"]]);var pe=Object.defineProperty({stateToString:he},"__esModule",{value:!0});const ve={aa:{name:"Afar",nativeName:"Afaraf"},ab:{name:"Abkhaz",nativeName:"аҧсуа бызшәа"},ae:{name:"Avestan",nativeName:"avesta"},af:{name:"Afrikaans",nativeName:"Afrikaans"},ak:{name:"Akan",nativeName:"Akan"},am:{name:"Amharic",nativeName:"አማርኛ"},an:{name:"Aragonese",nativeName:"aragonés"},ar:{name:"Arabic",nativeName:"اللغة العربية"},as:{name:"Assamese",nativeName:"অসমীয়া"},av:{name:"Avaric",nativeName:"авар мацӀ"},ay:{name:"Aymara",nativeName:"aymar aru"},az:{name:"Azerbaijani",nativeName:"azərbaycan dili"},ba:{name:"Bashkir",nativeName:"башҡорт теле"},be:{name:"Belarusian",nativeName:"беларуская мова"},bg:{name:"Bulgarian",nativeName:"български език"},bh:{name:"Bihari",nativeName:"भोजपुरी"},bi:{name:"Bislama",nativeName:"Bislama"},bm:{name:"Bambara",nativeName:"bamanankan"},bn:{name:"Bengali",nativeName:"বাংলা"},bo:{name:"Tibetan",nativeName:"བོད་ཡིག"},br:{name:"Breton",nativeName:"brezhoneg"},bs:{name:"Bosnian",nativeName:"bosanski jezik"},ca:{name:"Catalan",nativeName:"Català"},ce:{name:"Chechen",nativeName:"нохчийн мотт"},ch:{name:"Chamorro",nativeName:"Chamoru"},co:{name:"Corsican",nativeName:"corsu"},cr:{name:"Cree",nativeName:"ᓀᐦᐃᔭᐍᐏᐣ"},cs:{name:"Czech",nativeName:"čeština"},cu:{name:"Old Church Slavonic",nativeName:"ѩзыкъ словѣньскъ"},cv:{name:"Chuvash",nativeName:"чӑваш чӗлхи"},cy:{name:"Welsh",nativeName:"Cymraeg"},da:{name:"Danish",nativeName:"dansk"},de:{name:"German",nativeName:"Deutsch"},dv:{name:"Divehi",nativeName:"Dhivehi"},dz:{name:"Dzongkha",nativeName:"རྫོང་ཁ"},ee:{name:"Ewe",nativeName:"Eʋegbe"},el:{name:"Greek",nativeName:"Ελληνικά"},en:{name:"English",nativeName:"English"},eo:{name:"Esperanto",nativeName:"Esperanto"},es:{name:"Spanish",nativeName:"Español"},et:{name:"Estonian",nativeName:"eesti"},eu:{name:"Basque",nativeName:"euskara"},fa:{name:"Persian",nativeName:"فارسی"},ff:{name:"Fula",nativeName:"Fulfulde"},fi:{name:"Finnish",nativeName:"suomi"},fj:{name:"Fijian",nativeName:"Vakaviti"},fo:{name:"Faroese",nativeName:"føroyskt"},fr:{name:"French",nativeName:"Français"},fy:{name:"Western Frisian",nativeName:"Frysk"},ga:{name:"Irish",nativeName:"Gaeilge"},gd:{name:"Scottish Gaelic",nativeName:"Gàidhlig"},gl:{name:"Galician",nativeName:"galego"},gn:{name:"Guaraní",nativeName:"Avañe'ẽ"},gu:{name:"Gujarati",nativeName:"ગુજરાતી"},gv:{name:"Manx",nativeName:"Gaelg"},ha:{name:"Hausa",nativeName:"هَوُسَ"},he:{name:"Hebrew",nativeName:"עברית"},hi:{name:"Hindi",nativeName:"हिन्दी"},ho:{name:"Hiri Motu",nativeName:"Hiri Motu"},hr:{name:"Croatian",nativeName:"Hrvatski"},ht:{name:"Haitian",nativeName:"Kreyòl ayisyen"},hu:{name:"Hungarian",nativeName:"magyar"},hy:{name:"Armenian",nativeName:"Հայերեն"},hz:{name:"Herero",nativeName:"Otjiherero"},ia:{name:"Interlingua",nativeName:"Interlingua"},id:{name:"Indonesian",nativeName:"Bahasa Indonesia"},ie:{name:"Interlingue",nativeName:"Interlingue"},ig:{name:"Igbo",nativeName:"Asụsụ Igbo"},ii:{name:"Nuosu",nativeName:"ꆈꌠ꒿ Nuosuhxop"},ik:{name:"Inupiaq",nativeName:"Iñupiaq"},io:{name:"Ido",nativeName:"Ido"},is:{name:"Icelandic",nativeName:"Íslenska"},it:{name:"Italian",nativeName:"Italiano"},iu:{name:"Inuktitut",nativeName:"ᐃᓄᒃᑎᑐᑦ"},ja:{name:"Japanese",nativeName:"日本語"},jv:{name:"Javanese",nativeName:"basa Jawa"},ka:{name:"Georgian",nativeName:"ქართული"},kg:{name:"Kongo",nativeName:"Kikongo"},ki:{name:"Kikuyu",nativeName:"Gĩkũyũ"},kj:{name:"Kwanyama",nativeName:"Kuanyama"},kk:{name:"Kazakh",nativeName:"қазақ тілі"},kl:{name:"Kalaallisut",nativeName:"kalaallisut"},km:{name:"Khmer",nativeName:"ខេមរភាសា"},kn:{name:"Kannada",nativeName:"ಕನ್ನಡ"},ko:{name:"Korean",nativeName:"한국어"},kr:{name:"Kanuri",nativeName:"Kanuri"},ks:{name:"Kashmiri",nativeName:"कश्मीरी"},ku:{name:"Kurdish",nativeName:"Kurdî"},kv:{name:"Komi",nativeName:"коми кыв"},kw:{name:"Cornish",nativeName:"Kernewek"},ky:{name:"Kyrgyz",nativeName:"Кыргызча"},la:{name:"Latin",nativeName:"latine"},lb:{name:"Luxembourgish",nativeName:"Lëtzebuergesch"},lg:{name:"Ganda",nativeName:"Luganda"},li:{name:"Limburgish",nativeName:"Limburgs"},ln:{name:"Lingala",nativeName:"Lingála"},lo:{name:"Lao",nativeName:"ພາສາ"},lt:{name:"Lithuanian",nativeName:"lietuvių kalba"},lu:{name:"Luba-Katanga",nativeName:"Tshiluba"},lv:{name:"Latvian",nativeName:"latviešu valoda"},mg:{name:"Malagasy",nativeName:"fiteny malagasy"},mh:{name:"Marshallese",nativeName:"Kajin M̧ajeļ"},mi:{name:"Māori",nativeName:"te reo Māori"},mk:{name:"Macedonian",nativeName:"македонски јазик"},ml:{name:"Malayalam",nativeName:"മലയാളം"},mn:{name:"Mongolian",nativeName:"Монгол хэл"},mr:{name:"Marathi",nativeName:"मराठी"},ms:{name:"Malay",nativeName:"Bahasa Malaysia"},mt:{name:"Maltese",nativeName:"Malti"},my:{name:"Burmese",nativeName:"ဗမာစာ"},na:{name:"Nauru",nativeName:"Ekakairũ Naoero"},nb:{name:"Norwegian Bokmål",nativeName:"Norsk bokmål"},nd:{name:"Northern Ndebele",nativeName:"isiNdebele"},ne:{name:"Nepali",nativeName:"नेपाली"},ng:{name:"Ndonga",nativeName:"Owambo"},nl:{name:"Dutch",nativeName:"Nederlands"},nn:{name:"Norwegian Nynorsk",nativeName:"Norsk nynorsk"},no:{name:"Norwegian",nativeName:"Norsk"},nr:{name:"Southern Ndebele",nativeName:"isiNdebele"},nv:{name:"Navajo",nativeName:"Diné bizaad"},ny:{name:"Chichewa",nativeName:"chiCheŵa"},oc:{name:"Occitan",nativeName:"occitan"},oj:{name:"Ojibwe",nativeName:"ᐊᓂᔑᓈᐯᒧᐎᓐ"},om:{name:"Oromo",nativeName:"Afaan Oromoo"},or:{name:"Oriya",nativeName:"ଓଡ଼ିଆ"},os:{name:"Ossetian",nativeName:"ирон æвзаг"},pa:{name:"Panjabi",nativeName:"ਪੰਜਾਬੀ"},pi:{name:"Pāli",nativeName:"पाऴि"},pl:{name:"Polish",nativeName:"język polski"},ps:{name:"Pashto",nativeName:"پښتو"},pt:{name:"Portuguese",nativeName:"Português"},qu:{name:"Quechua",nativeName:"Runa Simi"},rm:{name:"Romansh",nativeName:"rumantsch grischun"},rn:{name:"Kirundi",nativeName:"Ikirundi"},ro:{name:"Romanian",nativeName:"Română"},ru:{name:"Russian",nativeName:"Русский"},rw:{name:"Kinyarwanda",nativeName:"Ikinyarwanda"},sa:{name:"Sanskrit",nativeName:"संस्कृतम्"},sc:{name:"Sardinian",nativeName:"sardu"},sd:{name:"Sindhi",nativeName:"सिन्धी"},se:{name:"Northern Sami",nativeName:"Davvisámegiella"},sg:{name:"Sango",nativeName:"yângâ tî sängö"},si:{name:"Sinhala",nativeName:"සිංහල"},sk:{name:"Slovak",nativeName:"slovenčina"},sl:{name:"Slovenian",nativeName:"slovenski jezik"},sm:{name:"Samoan",nativeName:"gagana fa'a Samoa"},sn:{name:"Shona",nativeName:"chiShona"},so:{name:"Somali",nativeName:"Soomaaliga"},sq:{name:"Albanian",nativeName:"Shqip"},sr:{name:"Serbian",nativeName:"српски језик"},ss:{name:"Swati",nativeName:"SiSwati"},st:{name:"Southern Sotho",nativeName:"Sesotho"},su:{name:"Sundanese",nativeName:"Basa Sunda"},sv:{name:"Swedish",nativeName:"Svenska"},sw:{name:"Swahili",nativeName:"Kiswahili"},ta:{name:"Tamil",nativeName:"தமிழ்"},te:{name:"Telugu",nativeName:"తెలుగు"},tg:{name:"Tajik",nativeName:"тоҷикӣ"},th:{name:"Thai",nativeName:"ไทย"},ti:{name:"Tigrinya",nativeName:"ትግርኛ"},tk:{name:"Turkmen",nativeName:"Türkmen"},tl:{name:"Tagalog",nativeName:"Wikang Tagalog"},tn:{name:"Tswana",nativeName:"Setswana"},to:{name:"Tonga",nativeName:"faka Tonga"},tr:{name:"Turkish",nativeName:"Türkçe"},ts:{name:"Tsonga",nativeName:"Xitsonga"},tt:{name:"Tatar",nativeName:"татар теле"},tw:{name:"Twi",nativeName:"Twi"},ty:{name:"Tahitian",nativeName:"Reo Tahiti"},ug:{name:"Uyghur",nativeName:"ئۇيغۇرچە‎"},uk:{name:"Ukrainian",nativeName:"Українська"},ur:{name:"Urdu",nativeName:"اردو"},uz:{name:"Uzbek",nativeName:"Ўзбек"},ve:{name:"Venda",nativeName:"Tshivenḓa"},vi:{name:"Vietnamese",nativeName:"Tiếng Việt"},vo:{name:"Volapük",nativeName:"Volapük"},wa:{name:"Walloon",nativeName:"walon"},wo:{name:"Wolof",nativeName:"Wollof"},xh:{name:"Xhosa",nativeName:"isiXhosa"},yi:{name:"Yiddish",nativeName:"ייִדיש"},yo:{name:"Yoruba",nativeName:"Yorùbá"},za:{name:"Zhuang",nativeName:"Saɯ cueŋƅ"},zh:{name:"Chinese",nativeName:"中文"},zu:{name:"Zulu",nativeName:"isiZulu"}};class ge{static getLanguages(e=[]){return e.map((e=>({code:e,name:ge.getName(e),nativeName:ge.getNativeName(e)})))}static getName(e){return ge.validate(e)?ve[e].name:""}static getAllNames(){return Object.values(ve).map((e=>e.name))}static getNativeName(e){return ge.validate(e)?ve[e].nativeName:""}static getAllNativeNames(){return Object.values(ve).map((e=>e.nativeName))}static getCode(e){return Object.keys(ve).find((t=>{const n=ve[t];return n.name.toLowerCase()===e.toLowerCase()||n.nativeName.toLowerCase()===e.toLowerCase()}))||""}static getAllCodes(){return Object.keys(ve)}static validate(e){return ve.hasOwnProperty(e)}}const ye={aa:"阿法尔语",ab:"阿布哈兹语",ae:"阿维斯陀语",af:"南非荷兰语",ak:"阿坎语",am:"阿姆哈拉语",an:"阿拉贡语",ar:"阿拉伯语",as:"阿萨姆语",av:"阿瓦尔语",ay:"艾马拉语",az:"阿塞拜疆语",ba:"巴什基尔语",be:"白俄罗斯语",bg:"保加利亚语",bh:"比哈尔语",bi:"比斯拉马语",bm:"班巴拉语",bn:"孟加拉语",bo:"藏语",br:"布列塔尼语",bs:"波斯尼亚语",ca:"加泰罗尼亚语",ce:"车臣语",ch:"查莫洛语",co:"科西嘉语",cr:"克里语",cs:"捷克语",cu:"古教会斯拉夫语",cv:"楚瓦什语",cy:"威尔士语",da:"丹麦语",de:"德语",dv:"迪维希语",dz:"不丹语",ee:"埃维语",el:"希腊语",en:"英语",eo:"世界语",es:"西班牙语",et:"爱沙尼亚语",eu:"巴斯克语",fa:"波斯语",ff:"富拉语",fi:"芬兰语",fj:"斐济语",fo:"法罗语",fr:"法语",fy:"西弗里西亚语",ga:"爱尔兰语",gd:"苏格兰盖尔语",gl:"加利西亚语",gn:"瓜拉尼语",gu:"古吉拉特语",gv:"马恩岛语",ha:"豪萨语",he:"希伯来语",hi:"印地语",ho:"莫图语",hr:"克罗地亚语",ht:"海地文",hu:"匈牙利语",hy:"亚美尼亚语",hz:"赫勒娄语",ia:"国际语",id:"印尼语",ie:"国际语",ig:"伊博语",ii:"诺苏语",ik:"依奴皮维克文",io:"伊多文",is:"冰岛语",it:"意大利语",iu:"因纽特语",ja:"日语",jv:"爪哇语",ka:"格鲁吉亚语",kg:"刚果语",ki:"基库尤语",kj:"宽亚马语",kk:"哈萨克语",kl:"格陵兰语",km:"高棉语",kn:"卡纳达语",ko:"韩语",kr:"卡努里语",ks:"克什米尔语",ku:"库尔德语",kv:"科米语",kw:"科尼什语",ky:"吉尔吉斯语",la:"拉丁语",lb:"卢森堡语",lg:"甘达语",li:"林堡语",ln:"林加拉语",lo:"老挝语",lt:"立陶宛语",lu:"卢巴加丹加语",lv:"拉脱维亚语",mg:"马尔加什语",mh:"马绍尔语",mi:"毛利语",mk:"马其顿语",ml:"马拉雅拉姆语",mn:"蒙古文",mr:"马拉地语",ms:"马来语",mt:"马耳他语",my:"缅甸语",na:"瑙鲁语",nb:"挪威博克马尔语",nd:"北恩德贝勒语",ne:"尼泊尔语",ng:"尼日尔刚果语",nl:"荷兰语",nn:"挪威尼诺斯克语",no:"挪威语",nr:"南恩德贝勒语",nv:"纳瓦霍语",ny:"齐切瓦语",oc:"奥克西唐语",oj:"欧及布威语",om:"奥罗莫语",or:"奥里亚语",os:"奥塞梯语",pa:"旁遮普语",pi:"巴利语",pl:"波兰语",ps:"普什图语",pt:"葡萄牙语",qu:"克丘亚语",rm:"罗曼斯语",rn:"基隆迪语",ro:"罗马尼亚语",ru:"俄语",rw:"卢旺达语",sa:"梵文",sc:"撒丁岛语",sd:"信德语",se:"北萨米文",sg:"桑戈语",si:"僧伽罗语",sk:"斯洛伐克语",sl:"斯洛文尼亚语",sm:"萨摩亚语",sn:"绍纳语",so:"索马里语",sq:"阿尔巴尼亚语",sr:"塞尔维亚语",ss:"斯瓦蒂语",st:"南索托语",su:"巽他语",sv:"瑞典语",sw:"斯瓦希里语",ta:"泰米尔语",te:"泰卢固语",tg:"塔吉克语",th:"泰语",ti:"提格雷语",tk:"土库曼语",tl:"菲律宾语",tn:"茨瓦纳语",to:"汤加语",tr:"土耳其语",ts:"特松加语",tt:"塔塔尔语",tw:"契维语",ty:"塔希提语",ug:"维吾尔语",uk:"乌克兰语",ur:"乌尔都语",uz:"乌兹别克语",ve:"文达语",vi:"越南语",vo:"沃拉普克语",wa:"华隆语",wo:"沃洛夫语",xh:"科萨语",yi:"意第绪语",yo:"约鲁巴语",za:"壮语",zh:"中文",zu:"祖鲁语"};class Se extends ge{static getLanguages(e){return super.getLanguages(e).map((e=>(Object.assign(e,{zhName:Se.getZhName(e.code)}),e)))}static getZhName(e){return super.validate(e)?ye[e]:""}static getAllZhNames(){return Object.values(ye)}}var be,we,Ce=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)};function Ne(e,t,n,a){return e.call(a,t[n],n,t)}var ke=function(e,t,n){var a,i=0;for(a in null==be&&function(){for(var e in we=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],be=!0,{toString:null})be=!1}(),e)if(!1===Ne(t,e,a,n))break;if(be)for(var r=e.constructor,o=!!r&&e===r.prototype;(a=we[i++])&&("constructor"===a&&(o||!Ce(e,a))||e[a]===Object.prototype[a]||!1!==Ne(t,e,a,n)););};var Te=function(e){var t=[];return ke(e,(function(e,n){"function"==typeof e&&t.push(n)})),t.sort()};var Ae=function(e,t,n){var a=e.length;t=null==t?0:t<0?Math.max(a+t,0):Math.min(t,a),n=null==n?a:n<0?Math.max(a+n,0):Math.min(n,a);for(var i=[];t<n;)i.push(e[t++]);return i};var Ee=function(e,t,n){var a=Ae(arguments,2);return function(){return e.apply(t,a.concat(Ae(arguments)))}};var _e=function(e,t,n){if(null!=e)for(var a=-1,i=e.length;++a<i&&!1!==t.call(n,e[a],a,e););};var Ie=function(e,t){var n=arguments.length>1?Ae(arguments,1):Te(e);_e(n,(function(t){e[t]=Ee(e[t],e)}))};var Re=function(e,t,n){ke(e,(function(a,i){if(Ce(e,i))return t.call(n,e[i],i,e)}))};var xe=function(e){return e};var Me=function(e){return function(t){return t[e]}},Oe=/^\[object (.*)\]$/,Pe=Object.prototype.toString;var Le=function(e){return null===e?"Null":undefined===e?"Undefined":Oe.exec(Pe.call(e))[1]};var Be=function(e,t){return Le(e)===t},Fe=Array.isArray||function(e){return Be(e,"Array")};function De(e,t){for(var n=-1,a=e.length;++n<a;)if(ze(e[n],t))return!0;return!1}function ze(e,t){return e&&"object"==typeof e?Fe(e)&&Fe(t)?function(e,t){for(var n=-1,a=t.length;++n<a;)if(!De(e,t[n]))return!1;return!0}(e,t):function(e,t){var n=!0;return Re(t,(function(t,a){if(!ze(e[a],t))return n=!1})),n}(e,t):e===t}var $e=ze;var je=function(e,t){if(null==e)return xe;switch(typeof e){case"function":return void 0!==t?function(n,a,i){return e.call(t,n,a,i)}:e;case"object":return function(t){return $e(t,e)};case"string":case"number":return Me(e)}};var We=function(e,t,n){t=je(t,n);var a=!1;return Re(e,(function(n,i){if(t(n,i,e))return a=!0,!1})),a};var Ue=function(e,t){return We(e,(function(e){return e===t}))};var Ge=function(e){return!!e&&"object"==typeof e&&e.constructor===Object};var Ke=function e(t,n){for(var a,i=0,r=arguments.length;++i<r;)(a=arguments[i])&&Re(a,(function(n,a){var i=t[a];null==i?t[a]=n:Ge(i)&&Ge(n)&&e(i,n)}));return t};function Ve(e,t){for(var n,a=0,i=arguments.length;++a<i;)(n=arguments[a])&&Re(n,He,e);return e}function He(e,t){var n=this[t];Ge(e)&&Ge(n)?Ve(n,e):this[t]=e}var Je=Ve;var Ze=function(e,t,n){t=je(t,n);var a=!0;return Re(e,(function(n,i){if(!t(n,i,e))return a=!1,!1})),a};var Xe=function(e){return Be(e,"Object")};var qe=function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t};function Ye(e,t){return Ce(this,t)}var Qe=function(e,t,n){return n=n||qe,Xe(e)&&Xe(t)?Ze(e,function(e){return function(t,n){return Ce(this,n)&&e(t,this[n])}}(n),t)&&Ze(t,Ye,e):n(e,t)};var et=function(e,t){return _e(Ae(arguments,1),(function(t){Re(t,(function(t,n){null==e[n]&&(e[n]=t)}))})),e};var tt=function(e,t,n){t=je(t,n);var a={};return Re(e,(function(e,n,i){t(e,n,i)&&(a[n]=e)})),a};var nt=function(e,t,n){var a;return t=je(t,n),We(e,(function(e,n,i){if(t(e,n,i))return a=e,!0})),a};function at(e,t,n,a){return Re(e,(function(e,i){var r=n?n+"."+i:i;0!==a&&Ge(e)?at(e,t,r,a-1):t[r]=e})),t}var it=function(e,t){return null==e?{}:at(e,{},"",t=null==t?-1:t)};var rt=function(e,t){for(var n=t.split("."),a=n.pop();t=n.shift();)if(null==(e=e[t]))return;return e[a]};var ot=function(e,t){return undefined!==rt(e,t)},st=Object.keys||function(e){var t=[];return Re(e,(function(e,n){t.push(n)})),t};var lt=function(e,t,n){t=je(t,n);var a={};return Re(e,(function(e,n,i){a[n]=t(e,n,i)})),a};var ct=function(e,t){var n=!0;return Re(t,(function(t,a){if(e[a]!==t)return n=!1})),n};var ut=function(e,t,n){if(null!=e&&e.length){if(e.length&&!t)return Math.max.apply(Math,e);t=je(t,n);for(var a,i,r,o=-1/0,s=-1,l=e.length;++s<l;)(r=t(i=e[s],s,e))>o&&(o=r,a=i);return a}return 1/0};var dt=function(e){var t=[];return Re(e,(function(e,n){t.push(e)})),t};function ht(e,t){this[t]=e}var mt=function(e,t){for(var n,a=0,i=arguments.length;++a<i;)null!=(n=arguments[a])&&Re(n,ht,e);return e};var ft=function(e){switch(Le(e)){case"Object":return Ge(a=e)?mt({},a):a;case"Array":return e.slice();case"RegExp":return n="",n+=(t=e).multiline?"m":"",n+=t.global?"g":"",n+=t.ignoreCase?"i":"",new RegExp(t.source,n);case"Date":return new Date(+e);default:return e}var t,n,a};function pt(e,t){switch(Le(e)){case"Object":return function(e,t){if(Ge(e)){var n={};return Re(e,(function(e,n){this[n]=pt(e,t)}),n),n}return t?t(e):e}(e,t);case"Array":return function(e,t){var n=[],a=-1,i=e.length;for(;++a<i;)n[a]=pt(e[a],t);return n}(e,t);default:return ft(e)}}var vt=pt;var gt=function e(){var t,n,a,i,r=1;for(i=vt(arguments[0]);a=arguments[r++];)for(t in a)Ce(a,t)&&(n=a[t],Xe(n)&&Xe(i[t])?i[t]=e(i[t],n):i[t]=vt(n));return i};var yt=function(e,t,n){if(null!=e&&e.length){if(e.length&&!t)return Math.min.apply(Math,e);t=je(t,n);for(var a,i,r,o=1/0,s=-1,l=e.length;++s<l;)(r=t(i=e[s],s,e))<o&&(o=r,a=i);return a}return-1/0};var St=function(e,t){return t?(_e(t.split("."),(function(t){e[t]||(e[t]={}),e=e[t]})),e):e};var bt=function(e,t,n){if(n=n||0,null==e)return-1;for(var a=e.length,i=n<0?a+n:n;i<a;){if(e[i]===t)return i;i++}return-1};var wt=function(e,t){return-1!==bt(e,t)};var Ct=function(e,t){return lt(e,Me(t))};var Nt=function(e){var t=0;return Re(e,(function(){t++})),t};var kt=function(e,t,n,a){var i=arguments.length>2;if(!Nt(e)&&!i)throw new Error("reduce of empty object with no initial value");return Re(e,(function(e,r,o){i?n=t.call(a,n,e,r,o):(n=e,i=!0)})),n};var Tt=function(e,t,n){return t=je(t,n),tt(e,(function(e,n,a){return!t(e,n,a)}),n)};var At=function(e){return Be(e,"Function")};var Et=function(e,t,n){var a=/^(.+)\.(.+)$/.exec(t);a?St(e,a[1])[a[2]]=n:e[t]=n};var _t=function(e,t){if(ot(e,t)){for(var n=t.split("."),a=n.pop();t=n.shift();)e=e[t];return delete e[a]}return!0},It={bindAll:Ie,contains:Ue,deepFillIn:Ke,deepMatches:$e,deepMixIn:Je,equals:Qe,every:Ze,fillIn:et,filter:tt,find:nt,flatten:it,forIn:ke,forOwn:Re,functions:Te,get:rt,has:ot,hasOwn:Ce,keys:st,map:lt,matches:ct,max:function(e,t){return ut(dt(e),t)},merge:gt,min:function(e,t){return yt(dt(e),t)},mixIn:mt,namespace:St,omit:function(e,t){var n="string"!=typeof arguments[1]?arguments[1]:Ae(arguments,1),a={};for(var i in e)e.hasOwnProperty(i)&&!wt(n,i)&&(a[i]=e[i]);return a},pick:function(e,t){for(var n,a="string"!=typeof arguments[1]?arguments[1]:Ae(arguments,1),i={},r=0;n=a[r++];)i[n]=e[n];return i},pluck:Ct,reduce:kt,reject:Tt,result:function(e,t){var n=e[t];if(void 0!==n)return At(n)?n.call(e):n},set:Et,size:Nt,some:We,unset:_t,values:dt},Rt=ue((function(e){(function(){var t,n,a;n=It,t=function(){function e(){}return e.prototype.getCountry=function(t){return e.prototype.countries[t]},e.prototype.getCode=function(t){var a,i;return i=null,null!=t&&-1!==(a=n.values(e.prototype.countries).indexOf(t))&&(i=Object.keys(e.prototype.countries)[a]),i},e.prototype.getCountries=function(){return n.values(e.prototype.countries)},e.prototype.getCodes=function(){return Object.keys(e.prototype.countries)},e.prototype.getData=function(){return e.prototype.countries},e.prototype.countries={AF:"Afghanistan",AX:"Åland Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"Côte d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Curaçao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Mcdonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"Réunion",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barthélemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"},e}(),a=null,e.exports=null!=a?a:a=new t}).call(le)}));const xt=/^([a-z]{2})-([A-Z]{2})$/;class Mt{static getLanguageCode(e){var t=e.match(xt);return!t||t.length<1?"":t[1]}static getLanguageName(e){var t=Mt.getLanguageCode(e);return Se.getName(t)}static getLanguageNativeName(e){var t=Mt.getLanguageCode(e);return Se.getNativeName(t)}static getLanguageZhName(e){var t=Mt.getLanguageCode(e);return Se.getZhName(t)}static validateLanguageCode(e){var t=Mt.getLanguageCode(e);return Se.validate(t)}static getLanguages(e){for(var t=[],n=0;n<e.length;n++)t.push({code:e[n],name:Mt.getLanguageName(e[n]),nativeName:Mt.getLanguageNativeName(e[n]),zhName:Mt.getLanguageZhName(e[n])});return t}static getCountryCode(e){var t=e.match(xt);return!t||t.length<2?"":t[2]}static getCountryName(e){var t=Mt.getCountryCode(e);return Rt.getCountry(t)}static validateCountryCode(e){return e=Mt.getCountryCode(e),-1!==Rt.getCodes().indexOf(e)}static validate(e){var t=e.match(xt);return!!(t&&3===t.length&&Mt.validateLanguageCode(e)&&Mt.validateCountryCode(e))}}var Ot,Pt=Object.freeze({__proto__:null,default:Mt}),Lt=new Uint8Array(16);function Bt(){if(!Ot&&!(Ot="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Ot(Lt)}var Ft=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Dt(e){return"string"==typeof e&&Ft.test(e)}for(var zt,$t,jt=[],Wt=0;Wt<256;++Wt)jt.push((Wt+256).toString(16).substr(1));function Ut(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(jt[e[t+0]]+jt[e[t+1]]+jt[e[t+2]]+jt[e[t+3]]+"-"+jt[e[t+4]]+jt[e[t+5]]+"-"+jt[e[t+6]]+jt[e[t+7]]+"-"+jt[e[t+8]]+jt[e[t+9]]+"-"+jt[e[t+10]]+jt[e[t+11]]+jt[e[t+12]]+jt[e[t+13]]+jt[e[t+14]]+jt[e[t+15]]).toLowerCase();if(!Dt(n))throw TypeError("Stringified UUID is invalid");return n}var Gt=0,Kt=0;function Vt(e){if(!Dt(e))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(e.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=255&t,n[4]=(t=parseInt(e.slice(9,13),16))>>>8,n[5]=255&t,n[6]=(t=parseInt(e.slice(14,18),16))>>>8,n[7]=255&t,n[8]=(t=parseInt(e.slice(19,23),16))>>>8,n[9]=255&t,n[10]=(t=parseInt(e.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=255&t,n}function Ht(e,t,n){function a(e,a,i,r){if("string"==typeof e&&(e=function(e){e=unescape(encodeURIComponent(e));for(var t=[],n=0;n<e.length;++n)t.push(e.charCodeAt(n));return t}(e)),"string"==typeof a&&(a=Vt(a)),16!==a.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var o=new Uint8Array(16+e.length);if(o.set(a),o.set(e,a.length),(o=n(o))[6]=15&o[6]|t,o[8]=63&o[8]|128,i){r=r||0;for(var s=0;s<16;++s)i[r+s]=o[s];return i}return Ut(o)}try{a.name=e}catch(e){}return a.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",a.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",a}function Jt(e){return 14+(e+64>>>9<<4)+1}function Zt(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function Xt(e,t,n,a,i,r){return Zt((o=Zt(Zt(t,e),Zt(a,r)))<<(s=i)|o>>>32-s,n);var o,s}function qt(e,t,n,a,i,r,o){return Xt(t&n|~t&a,e,t,i,r,o)}function Yt(e,t,n,a,i,r,o){return Xt(t&a|n&~a,e,t,i,r,o)}function Qt(e,t,n,a,i,r,o){return Xt(t^n^a,e,t,i,r,o)}function en(e,t,n,a,i,r,o){return Xt(n^(t|~a),e,t,i,r,o)}var tn=Ht("v3",48,(function(e){if("string"==typeof e){var t=unescape(encodeURIComponent(e));e=new Uint8Array(t.length);for(var n=0;n<t.length;++n)e[n]=t.charCodeAt(n)}return function(e){for(var t=[],n=32*e.length,a="0123456789abcdef",i=0;i<n;i+=8){var r=e[i>>5]>>>i%32&255,o=parseInt(a.charAt(r>>>4&15)+a.charAt(15&r),16);t.push(o)}return t}(function(e,t){e[t>>5]|=128<<t%32,e[Jt(t)-1]=t;for(var n=1732584193,a=-271733879,i=-1732584194,r=271733878,o=0;o<e.length;o+=16){var s=n,l=a,c=i,u=r;n=qt(n,a,i,r,e[o],7,-680876936),r=qt(r,n,a,i,e[o+1],12,-389564586),i=qt(i,r,n,a,e[o+2],17,606105819),a=qt(a,i,r,n,e[o+3],22,-1044525330),n=qt(n,a,i,r,e[o+4],7,-176418897),r=qt(r,n,a,i,e[o+5],12,1200080426),i=qt(i,r,n,a,e[o+6],17,-1473231341),a=qt(a,i,r,n,e[o+7],22,-45705983),n=qt(n,a,i,r,e[o+8],7,1770035416),r=qt(r,n,a,i,e[o+9],12,-1958414417),i=qt(i,r,n,a,e[o+10],17,-42063),a=qt(a,i,r,n,e[o+11],22,-1990404162),n=qt(n,a,i,r,e[o+12],7,1804603682),r=qt(r,n,a,i,e[o+13],12,-40341101),i=qt(i,r,n,a,e[o+14],17,-1502002290),n=Yt(n,a=qt(a,i,r,n,e[o+15],22,1236535329),i,r,e[o+1],5,-165796510),r=Yt(r,n,a,i,e[o+6],9,-1069501632),i=Yt(i,r,n,a,e[o+11],14,643717713),a=Yt(a,i,r,n,e[o],20,-373897302),n=Yt(n,a,i,r,e[o+5],5,-701558691),r=Yt(r,n,a,i,e[o+10],9,38016083),i=Yt(i,r,n,a,e[o+15],14,-660478335),a=Yt(a,i,r,n,e[o+4],20,-405537848),n=Yt(n,a,i,r,e[o+9],5,568446438),r=Yt(r,n,a,i,e[o+14],9,-1019803690),i=Yt(i,r,n,a,e[o+3],14,-187363961),a=Yt(a,i,r,n,e[o+8],20,1163531501),n=Yt(n,a,i,r,e[o+13],5,-1444681467),r=Yt(r,n,a,i,e[o+2],9,-51403784),i=Yt(i,r,n,a,e[o+7],14,1735328473),n=Qt(n,a=Yt(a,i,r,n,e[o+12],20,-1926607734),i,r,e[o+5],4,-378558),r=Qt(r,n,a,i,e[o+8],11,-2022574463),i=Qt(i,r,n,a,e[o+11],16,1839030562),a=Qt(a,i,r,n,e[o+14],23,-35309556),n=Qt(n,a,i,r,e[o+1],4,-1530992060),r=Qt(r,n,a,i,e[o+4],11,1272893353),i=Qt(i,r,n,a,e[o+7],16,-155497632),a=Qt(a,i,r,n,e[o+10],23,-1094730640),n=Qt(n,a,i,r,e[o+13],4,681279174),r=Qt(r,n,a,i,e[o],11,-358537222),i=Qt(i,r,n,a,e[o+3],16,-722521979),a=Qt(a,i,r,n,e[o+6],23,76029189),n=Qt(n,a,i,r,e[o+9],4,-640364487),r=Qt(r,n,a,i,e[o+12],11,-421815835),i=Qt(i,r,n,a,e[o+15],16,530742520),n=en(n,a=Qt(a,i,r,n,e[o+2],23,-995338651),i,r,e[o],6,-198630844),r=en(r,n,a,i,e[o+7],10,1126891415),i=en(i,r,n,a,e[o+14],15,-1416354905),a=en(a,i,r,n,e[o+5],21,-57434055),n=en(n,a,i,r,e[o+12],6,1700485571),r=en(r,n,a,i,e[o+3],10,-1894986606),i=en(i,r,n,a,e[o+10],15,-1051523),a=en(a,i,r,n,e[o+1],21,-2054922799),n=en(n,a,i,r,e[o+8],6,1873313359),r=en(r,n,a,i,e[o+15],10,-30611744),i=en(i,r,n,a,e[o+6],15,-1560198380),a=en(a,i,r,n,e[o+13],21,1309151649),n=en(n,a,i,r,e[o+4],6,-145523070),r=en(r,n,a,i,e[o+11],10,-1120210379),i=en(i,r,n,a,e[o+2],15,718787259),a=en(a,i,r,n,e[o+9],21,-343485551),n=Zt(n,s),a=Zt(a,l),i=Zt(i,c),r=Zt(r,u)}return[n,a,i,r]}(function(e){if(0===e.length)return[];for(var t=8*e.length,n=new Uint32Array(Jt(t)),a=0;a<t;a+=8)n[a>>5]|=(255&e[a/8])<<a%32;return n}(e),8*e.length))}));function nn(e,t,n,a){switch(e){case 0:return t&n^~t&a;case 1:return t^n^a;case 2:return t&n^t&a^n&a;case 3:return t^n^a}}function an(e,t){return e<<t|e>>>32-t}var rn=Ht("v5",80,(function(e){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof e){var a=unescape(encodeURIComponent(e));e=[];for(var i=0;i<a.length;++i)e.push(a.charCodeAt(i))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var r=e.length/4+2,o=Math.ceil(r/16),s=new Array(o),l=0;l<o;++l){for(var c=new Uint32Array(16),u=0;u<16;++u)c[u]=e[64*l+4*u]<<24|e[64*l+4*u+1]<<16|e[64*l+4*u+2]<<8|e[64*l+4*u+3];s[l]=c}s[o-1][14]=8*(e.length-1)/Math.pow(2,32),s[o-1][14]=Math.floor(s[o-1][14]),s[o-1][15]=8*(e.length-1)&4294967295;for(var d=0;d<o;++d){for(var h=new Uint32Array(80),m=0;m<16;++m)h[m]=s[d][m];for(var f=16;f<80;++f)h[f]=an(h[f-3]^h[f-8]^h[f-14]^h[f-16],1);for(var p=n[0],v=n[1],g=n[2],y=n[3],S=n[4],b=0;b<80;++b){var w=Math.floor(b/20),C=an(p,5)+nn(w,v,g,y)+S+t[w]+h[b]>>>0;S=y,y=g,g=an(v,30)>>>0,v=p,p=C}n[0]=n[0]+p>>>0,n[1]=n[1]+v>>>0,n[2]=n[2]+g>>>0,n[3]=n[3]+y>>>0,n[4]=n[4]+S>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,255&n[0],n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,255&n[1],n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,255&n[2],n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,255&n[3],n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,255&n[4]]}));var on=Object.freeze({__proto__:null,v1:function(e,t,n){var a=t&&n||0,i=t||new Array(16),r=(e=e||{}).node||zt,o=void 0!==e.clockseq?e.clockseq:$t;if(null==r||null==o){var s=e.random||(e.rng||Bt)();null==r&&(r=zt=[1|s[0],s[1],s[2],s[3],s[4],s[5]]),null==o&&(o=$t=16383&(s[6]<<8|s[7]))}var l=void 0!==e.msecs?e.msecs:Date.now(),c=void 0!==e.nsecs?e.nsecs:Kt+1,u=l-Gt+(c-Kt)/1e4;if(u<0&&void 0===e.clockseq&&(o=o+1&16383),(u<0||l>Gt)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Gt=l,Kt=c,$t=o;var d=(1e4*(268435455&(l+=122192928e5))+c)%4294967296;i[a++]=d>>>24&255,i[a++]=d>>>16&255,i[a++]=d>>>8&255,i[a++]=255&d;var h=l/4294967296*1e4&268435455;i[a++]=h>>>8&255,i[a++]=255&h,i[a++]=h>>>24&15|16,i[a++]=h>>>16&255,i[a++]=o>>>8|128,i[a++]=255&o;for(var m=0;m<6;++m)i[a+m]=r[m];return t||Ut(i)},v3:tn,v4:function(e,t,n){var a=(e=e||{}).random||(e.rng||Bt)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=a[i];return t}return Ut(a)},v5:rn,NIL:"00000000-0000-0000-0000-000000000000",version:function(e){if(!Dt(e))throw TypeError("Invalid UUID");return parseInt(e.substr(14,1),16)},validate:Dt,stringify:Ut,parse:Vt}),sn=ue((function(e,t){!function(n){var a=t,i=e&&e.exports==a&&e,r="object"==typeof le&&le;r.global!==r&&r.window!==r||(n=r);var o=function(e){this.message=e};(o.prototype=new Error).name="InvalidCharacterError";var s=function(e){throw new o(e)},l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=/[\t\n\f\r ]/g,u={encode:function(e){e=String(e),/[^\0-\xFF]/.test(e)&&s("The string to be encoded contains characters outside of the Latin1 range.");for(var t,n,a,i,r=e.length%3,o="",c=-1,u=e.length-r;++c<u;)t=e.charCodeAt(c)<<16,n=e.charCodeAt(++c)<<8,a=e.charCodeAt(++c),o+=l.charAt((i=t+n+a)>>18&63)+l.charAt(i>>12&63)+l.charAt(i>>6&63)+l.charAt(63&i);return 2==r?(t=e.charCodeAt(c)<<8,n=e.charCodeAt(++c),o+=l.charAt((i=t+n)>>10)+l.charAt(i>>4&63)+l.charAt(i<<2&63)+"="):1==r&&(i=e.charCodeAt(c),o+=l.charAt(i>>2)+l.charAt(i<<4&63)+"=="),o},decode:function(e){var t=(e=String(e).replace(c,"")).length;t%4==0&&(t=(e=e.replace(/==?$/,"")).length),(t%4==1||/[^+a-zA-Z0-9/]/.test(e))&&s("Invalid character: the string to be decoded is not correctly encoded.");for(var n,a,i=0,r="",o=-1;++o<t;)a=l.indexOf(e.charAt(o)),n=i%4?64*n+a:a,i++%4&&(r+=String.fromCharCode(255&n>>(-2*i&6)));return r},version:"0.1.0"};if(a&&!a.nodeType)if(i)i.exports=u;else for(var d in u)u.hasOwnProperty(d)&&(a[d]=u[d]);else n.base64=u}(le)})),ln=ue((function(e,t){var n=le&&le.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))};function a(e,n,a,r,o=Date.now){const s=i(e);return!(s.expiresAtMs-o()<t.minTokenValidTime)&&(s.appId===a&&s.projectId===n&&s.deviceId===r)}function i(e){const t=e.split(".")[1];let n;try{n=JSON.parse(sn.decode(t))}catch(e){throw new Error("Error decoding Speechly token!")}return{appId:n.appId,projectId:n.projectId,deviceId:n.deviceId,configId:n.configId,scopes:n.scope.split(" "),issuer:n.iss,audience:n.aud,expiresAtMs:1e3*n.exp}}Object.defineProperty(t,"__esModule",{value:!0}),t.minTokenValidTime=36e5,t.fetchToken=function(e,t,i,r,o=fetch,s=Date.now){var l;return n(this,void 0,void 0,(function*(){let n;n=void 0!==t?{projectId:t,deviceId:r}:{appId:i,deviceId:r};const c=yield o(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),u=yield c.json();if(200!==c.status)throw Error(null!==(l=u.error)&&void 0!==l?l:`Speechly API login request failed with ${c.status}`);if(void 0===u.access_token)throw Error("Invalid login response from Speechly API");if(!a(u.access_token,t,i,r,s))throw Error("Invalid token received from Speechly API");return u.access_token}))},t.validateToken=a,t.decodeToken=i})),cn=new Error("Microphone is not initialized"),un=new Error("Microphone is already initialized"),dn=new Error("Current device does not support microphone API"),hn=new Error("Microphone consent is no given"),mn=Object.defineProperty({DefaultSampleRate:16e3,ErrNotInitialized:cn,ErrAlreadyInitialized:un,ErrDeviceNotSupported:dn,ErrNoAudioConsent:hn},"__esModule",{value:!0}),fn=Object.defineProperty({default:"\n// Indices for the Control SAB.\nconst CONTROL = {\n  'WRITE_INDEX': 0,\n  'FRAMES_AVAILABLE': 1,\n};\n\nclass SpeechlyProcessor extends AudioWorkletProcessor {\n  constructor() {\n    super();\n\n    this._initialized = false;\n    this.port.onmessage = this._initialize.bind(this);\n  }\n\n  _initialize(event) {\n    this.controlSAB = new Int32Array(event.data.controlSAB);\n    this.dataSAB = new Float32Array(event.data.dataSAB);\n    this._initialized = true;\n  }\n\n  _pushData(data) {\n    let inputWriteIndex = this.controlSAB[CONTROL.WRITE_INDEX];\n\n    if (inputWriteIndex + data.length < this.dataSAB.length) {\n      // Buffer has enough space to push the input.\n      this.dataSAB.set(data, inputWriteIndex);\n      this.controlSAB[CONTROL.WRITE_INDEX] += data.length;\n    } else {\n      // Buffer overflow\n      this.dataSAB.set(data, 0);\n      this.controlSAB[CONTROL.WRITE_INDEX] = 0;\n    }\n\n    // Update the number of available frames in the input buffer.\n    this.controlSAB[CONTROL.FRAMES_AVAILABLE] += data.length;\n  }\n\n  process(inputs, outputs, parameters) {\n    const inputChannelData = inputs[0][0];\n      if (inputChannelData !== undefined) {\n        if (this.controlSAB && this.dataSAB) {\n          this._pushData(inputChannelData);\n        } else {\n          this.port.postMessage(inputChannelData);\n        }\n      }\n      \n      return true;\n  }\n}\n\nregisterProcessor('speechly-worklet', SpeechlyProcessor);\n"},"__esModule",{value:!0}),pn=le&&le.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))};
/*! http://mths.be/base64 v0.1.0 by @mathias | MIT license */const vn=(le&&le.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(fn);var gn=class{constructor(e,t,n){this.initialized=!1,this.muted=!1,this.handleAudio=e=>{this.muted||e.length>0&&this.apiClient.sendAudio(e)},this.isWebkit=e,this.apiClient=n,this.sampleRate=t}initialize(e,t){var n;return pn(this,void 0,void 0,(function*(){if(void 0===(null===(n=window.navigator)||void 0===n?void 0:n.mediaDevices))throw mn.ErrDeviceNotSupported;this.audioContext=e,this.resampleRatio=this.audioContext.sampleRate/this.sampleRate;try{this.mediaStream=yield window.navigator.mediaDevices.getUserMedia(t)}catch(e){throw mn.ErrNoAudioConsent}if(this.audioTrack=this.mediaStream.getAudioTracks()[0],this.isWebkit||(yield this.audioContext.resume()),void 0!==window.AudioWorkletNode){const e=new Blob([vn.default],{type:"text/javascript"}),t=window.URL.createObjectURL(e);yield this.audioContext.audioWorklet.addModule(t);const n=new AudioWorkletNode(this.audioContext,"speechly-worklet");if(this.audioContext.createMediaStreamSource(this.mediaStream).connect(n),n.connect(this.audioContext.destination),void 0!==window.SharedArrayBuffer){const e=new window.SharedArrayBuffer(2*Int32Array.BYTES_PER_ELEMENT),t=new window.SharedArrayBuffer(8192*Float32Array.BYTES_PER_ELEMENT);this.apiClient.postMessage({type:"SET_SHARED_ARRAY_BUFFERS",controlSAB:e,dataSAB:t}),n.port.postMessage({type:"SET_SHARED_ARRAY_BUFFERS",controlSAB:e,dataSAB:t})}else n.port.onmessage=e=>{this.handleAudio(e.data)}}else{if(this.isWebkit){const e=4096*Math.pow(2,Math.ceil(Math.log(this.resampleRatio)/Math.log(2)));this.audioProcessor=this.audioContext.createScriptProcessor(e,1,1)}else this.audioProcessor=this.audioContext.createScriptProcessor(void 0,1,1);this.audioContext.createMediaStreamSource(this.mediaStream).connect(this.audioProcessor),this.audioProcessor.connect(this.audioContext.destination),this.audioProcessor.addEventListener("audioprocess",(e=>{this.handleAudio(e.inputBuffer.getChannelData(0))}))}this.initialized=!0,this.mute()}))}close(){return pn(this,void 0,void 0,(function*(){if(this.mute(),!this.initialized)throw mn.ErrNotInitialized;this.audioTrack.enabled=!1;if(this.mediaStream.getTracks().forEach((e=>e.stop())),null!=this.audioProcessor){this.audioProcessor.disconnect()}this.mediaStream=void 0,this.audioTrack=void 0,this.audioProcessor=void 0,this.initialized=!1}))}mute(){this.muted=!0}unmute(){this.muted=!1}},yn=Object.defineProperty({BrowserMicrophone:gn},"__esModule",{value:!0}),Sn=ue((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(yn),n(mn)})),bn=ue((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),(n=t.WebsocketResponseType||(t.WebsocketResponseType={})).Opened="WEBSOCKET_OPEN",n.SourceSampleRateSetSuccess="SOURSE_SAMPLE_RATE_SET_SUCCESS",n.Started="started",n.Stopped="stopped",n.SegmentEnd="segment_end",n.Transcript="transcript",n.Entity="entity",n.Intent="intent",n.TentativeTranscript="tentative_transcript",n.TentativeEntities="tentative_entities",n.TentativeIntent="tentative_intent"})),wn=Object.defineProperty({default:"\n// Indices for the Control SAB.\nconst CONTROL = {\n  WRITE_INDEX: 0,\n  FRAMES_AVAILABLE: 1,\n}\nlet ws\nlet url\nlet token\nconst state = {\n  isContextStarted: false,\n  isStartContextConfirmed: false,\n  shouldResendLastFramesSent: false,\n  sourceSampleRate: undefined,\n  targetSampleRate: undefined,\n  resampleRatio: 1,\n  buffer: new Float32Array(0),\n  lastFramesSent: new Int16Array(0), // to re-send after switch context\n  filter: undefined,\n  controlSAB: undefined,\n  dataSAB: undefined,\n}\n\nasync function initializeWebsocket() {\n  ws = new WebSocket(url, token)\n\n  return new Promise((resolve, reject) => {\n    const errhandler = () => {\n      ws.removeEventListener('close', errhandler)\n      ws.removeEventListener('error', errhandler)\n      ws.removeEventListener('open', openhandler)\n\n      reject(Error('Connection failed'))\n    }\n\n    const openhandler = () => {\n      ws.removeEventListener('close', errhandler)\n      ws.removeEventListener('error', errhandler)\n      ws.removeEventListener('open', openhandler)\n\n      resolve(ws)\n    }\n\n    ws.addEventListener('close', errhandler)\n    ws.addEventListener('error', errhandler)\n    ws.addEventListener('open', openhandler)\n  })\n}\n\nfunction connect(timeout = 1000) {\n  setTimeout(function() {\n    initializeWebsocket().then(function() {\n      console.log('connect')\n      self.postMessage({\n        type: 'WEBSOCKET_OPEN',\n      })\n      ws.addEventListener('message', onWebsocketMessage)\n      ws.addEventListener('error', onWebsocketError)\n      ws.addEventListener('close', onWebsocketClose)\n    }).catch((error) => {\n      console.log(error)\n      connect(1000)\n    })\n  }, timeout)\n}\n\nfunction closeWebsocket(code, message) {\n  if (ws === undefined) {\n    throw Error('Websocket is not open')\n  }\n\n  ws.removeEventListener('message', onWebsocketMessage)\n  ws.removeEventListener('error', onWebsocketError)\n  ws.removeEventListener('close', onWebsocketClose)\n\n  ws.close(code, message)\n}\n\nfunction onWebsocketClose(event) {\n  connect(0)\n}\n\nfunction onWebsocketError(_event) {\n  onWebsocketClose(1000, 'Client disconnecting due to an error')\n}\n\nfunction onWebsocketMessage(event) {\n  let response\n  try {\n    response = JSON.parse(event.data)\n  } catch (e) {\n    console.error('[SpeechlyClient] Error parsing response from the server:', e)\n    return\n  }\n\n  if (response.type === 'started') {\n    state.isStartContextConfirmed = true\n    if (state.shouldResendLastFramesSent) {\n      if (state.lastFramesSent.length > 0) {\n        if (ws !== undefined) {\n          ws.send(state.lastFramesSent)\n        }\n        state.lastFramesSent = new Int16Array(0)\n      }\n      state.shouldResendLastFramesSent = false\n    }\n  }\n\n  self.postMessage(response)\n}\n\nfunction float32ToInt16(buffer) {\n  const buf = new Int16Array(buffer.length)\n\n  for (let l = 0; l < buffer.length; l++) {\n    buf[l] = buffer[l] * (buffer[l] < 0 ? 0x8000 : 0x7fff)\n  }\n\n  return buf\n}\n\nself.onmessage = function(e) {\n  switch (e.data.type) {\n    case 'INIT':\n      if (ws === undefined) {\n        url = e.data.apiUrl\n        token = e.data.authToken\n        connect(0)\n        state.targetSampleRate = e.data.targetSampleRate\n      }\n      break\n    case 'SET_SOURSE_SAMPLE_RATE':\n      state.sourceSampleRate = e.data.sourceSampleRate\n      state.resampleRatio = e.data.sourceSampleRate / state.targetSampleRate\n      if (state.resampleRatio > 1) {\n        state.filter = generateFilter(e.data.sourceSampleRate, state.targetSampleRate, 127)\n      }\n      self.postMessage({\n        type: 'SOURSE_SAMPLE_RATE_SET_SUCCESS',\n      })\n\n      if (isNaN(state.resampleRatio)) {\n        throw Error('resampleRatio is NaN')\n      }\n      break\n    case 'SET_SHARED_ARRAY_BUFFERS':\n      state.controlSAB = new Int32Array(e.data.controlSAB)\n      state.dataSAB = new Float32Array(e.data.dataSAB)\n      setInterval(sendAudioFromSAB, 4)\n      break\n    case 'CLOSE':\n      if (ws !== undefined) {\n        closeWebsocket(e.data.code, e.data.message)\n      }\n      break\n    case 'START_CONTEXT':\n      if (ws === undefined) {\n        throw Error('Cant start context: websocket is undefined')\n      }\n      if (state.isContextStarted) {\n        console.log('Cant start context: it has been already started')\n        break\n      }\n\n      state.isContextStarted = true\n      state.isStartContextConfirmed = false\n\n      const appId = e.data.appId\n      if (appId !== undefined) {\n        ws.send(JSON.stringify({ event: 'start', appId }))\n      } else {\n        ws.send(JSON.stringify({ event: 'start' }))\n      }\n      break\n    case 'SWITCH_CONTEXT':\n      const newAppId = e.data.appId\n      if (ws !== undefined && state.isContextStarted && newAppId !== undefined) {\n        state.isStartContextConfirmed = false\n        const StopEventJSON = JSON.stringify({ event: 'stop' })\n        ws.send(StopEventJSON)\n        state.shouldResendLastFramesSent = true\n        ws.send(JSON.stringify({ event: 'start', appId: newAppId }))\n      }\n      break\n    case 'STOP_CONTEXT':\n      if (ws !== undefined && state.isContextStarted) {\n        state.isContextStarted = false\n        state.isStartContextConfirmed = false\n        const StopEventJSON = JSON.stringify({ event: 'stop' })\n        ws.send(StopEventJSON)\n      }\n      break\n    case 'AUDIO':\n      if (ws !== undefined && state.isContextStarted) {\n        if (e.data.payload.length > 0) {\n          if (state.resampleRatio > 1) {\n            // Downsampling\n            ws.send(downsample(e.data.payload))\n          } else {\n            ws.send(float32ToInt16(e.data.payload))\n          }\n        }\n      }\n      break\n    default:\n      console.log('WORKER', e)\n  }\n}\n\nlet lastTime = Date.now()\n\nfunction sendAudioFromSAB() {\n  if (state.isStartContextConfirmed && CONTROL.FRAMES_AVAILABLE > 0) {\n    const data = state.dataSAB.subarray(0, state.controlSAB[CONTROL.FRAMES_AVAILABLE])\n    state.controlSAB[CONTROL.FRAMES_AVAILABLE] = 0\n    state.controlSAB[CONTROL.WRITE_INDEX] = 0\n    if (data.length > 0) {\n      let frames\n      if (state.resampleRatio > 1) {\n        frames = downsample(data)\n      } else {\n        frames = float32ToInt16(data)\n      }\n      ws.send(frames)\n\n      // 16000 per second, 1000 in 100 ms\n      // save last 250 ms\n      if (state.lastFramesSent.length > 1024 * 4) {\n        state.lastFramesSent = frames\n      } else {\n        let concat = new Int16Array(state.lastFramesSent.length + frames.length)\n        concat.set(state.lastFramesSent)\n        concat.set(frames, state.lastFramesSent.length)\n        state.lastFramesSent = concat\n      }\n    }\n  } else {\n    if (!state.isContextStarted) {\n      state.controlSAB[CONTROL.FRAMES_AVAILABLE] = 0\n      state.controlSAB[CONTROL.WRITE_INDEX] = 0\n    }\n  }\n}\n\nfunction downsample(input) {\n  const inputBuffer = new Float32Array(state.buffer.length + input.length)\n  inputBuffer.set(state.buffer, 0)\n  inputBuffer.set(input, state.buffer.length)\n\n  const outputLength = Math.ceil((inputBuffer.length - state.filter.length) / state.resampleRatio)\n  const outputBuffer = new Int16Array(outputLength)\n\n  for (let i = 0; i < outputLength; i++) {\n    const offset = Math.round(state.resampleRatio * i)\n    let val = 0.0\n\n    for (let j = 0; j < state.filter.length; j++) {\n      val += inputBuffer[offset + j] * state.filter[j]\n    }\n\n    outputBuffer[i] = val * (val < 0 ? 0x8000 : 0x7fff)\n  }\n\n  const remainingOffset = Math.round(state.resampleRatio * outputLength)\n  if (remainingOffset < inputBuffer.length) {\n    state.buffer = inputBuffer.subarray(remainingOffset)\n  } else {\n    state.buffer = emptyBuffer\n  }\n\n  return outputBuffer\n}\n\nfunction generateFilter(sourceSampleRate, targetSampleRate, length) {\n  if (length % 2 === 0) {\n    throw Error('Filter length must be odd')\n  }\n\n  const cutoff = targetSampleRate / 2\n  const filter = new Float32Array(length)\n  let sum = 0\n\n  for (let i = 0; i < length; i++) {\n    const x = sinc(((2 * cutoff) / sourceSampleRate) * (i - (length - 1) / 2))\n\n    sum += x\n    filter[i] = x\n  }\n\n  for (let i = 0; i < length; i++) {\n    filter[i] = filter[i] / sum\n  }\n\n  return filter\n}\n\nfunction sinc(x) {\n  if (x === 0.0) {\n    return 1.0\n  }\n\n  const piX = Math.PI * x\n  return Math.sin(piX) / piX\n}\n\n"},"__esModule",{value:!0}),Cn=le&&le.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))};const Nn=(le&&le.__importDefault||function(e){return e&&e.__esModule?e:{default:e}})(wn);var kn=class{constructor(){this.startCbs=[],this.stopCbs=[],this.onResponseCb=()=>{},this.onCloseCb=()=>{},this.onWebsocketMessage=e=>{const t=e.data;switch(t.type){case bn.WebsocketResponseType.Opened:break;case bn.WebsocketResponseType.SourceSampleRateSetSuccess:null!=this.resolveInitialization&&this.resolveInitialization();break;case bn.WebsocketResponseType.Started:this.startCbs.forEach((e=>{try{e(void 0,t.audio_context)}catch(e){console.error('[SpeechlyClient] Error while invoking "onStart" callback:',e)}})),this.startCbs.length=0;break;case bn.WebsocketResponseType.Stopped:this.stopCbs.forEach((e=>{try{e(void 0,t.audio_context)}catch(e){console.error('[SpeechlyClient] Error while invoking "onStop" callback:',e)}})),this.stopCbs.length=0;break;default:this.onResponseCb(t)}};const e=new Blob([Nn.default],{type:"text/javascript"}),t=window.URL.createObjectURL(e);this.worker=new Worker(t),this.worker.addEventListener("message",this.onWebsocketMessage)}onResponse(e){this.onResponseCb=e}onClose(e){this.onCloseCb=e}initialize(e){return Cn(this,void 0,void 0,(function*(){return this.worker.postMessage({type:"SET_SOURSE_SAMPLE_RATE",sourceSampleRate:e}),new Promise((e=>{this.resolveInitialization=e}))}))}close(){return Cn(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.worker.postMessage({type:"CLOSE",code:1e3,message:"Client has ended the session"}),e()}))}))}startContext(e){return Cn(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{this.startCbs.push(((e,a)=>{void 0!==e?n(e):t(a)})),null!=e?this.worker.postMessage({type:"START_CONTEXT",appId:e}):this.worker.postMessage({type:"START_CONTEXT"})}))}))}stopContext(){return Cn(this,void 0,void 0,(function*(){return new Promise(((e,t)=>{this.stopCbs.push(((n,a)=>{void 0!==n?t(n):e(a)})),this.worker.postMessage({type:"STOP_CONTEXT"})}))}))}switchContext(e){return Cn(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{this.startCbs.push(((e,a)=>{void 0!==e?n(e):t(a)})),this.worker.postMessage({type:"SWITCH_CONTEXT",appId:e})}))}))}postMessage(e){this.worker.postMessage(e)}sendAudio(e){this.worker.postMessage({type:"AUDIO",payload:e})}},Tn=Object.defineProperty({WebWorkerController:kn},"__esModule",{value:!0}),An=ue((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(Tn),n(bn)}));var En=class{constructor(){this.storage=window.localStorage}get(e){return this.storage.getItem(e)}set(e,t){this.storage.setItem(e,t)}getOrSet(e,t){let n=this.storage.getItem(e);return null===n&&(n=t(),this.storage.setItem(e,n)),n}},_n=Object.defineProperty({LocalStorage:En},"__esModule",{value:!0}),In=new Error("Current device does not support storage API"),Rn=new Error("Requested key was not present in storage"),xn=Object.defineProperty({ErrNoStorageSupport:In,ErrKeyNotFound:Rn},"__esModule",{value:!0}),Mn=ue((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(_n),n(xn)}));var On=class{constructor(e,t){this.isFinalized=!1,this.words=[],this.entities=new Map,this.intent={intent:"",isFinal:!1},this.contextId=e,this.id=t}toSegment(){let e=0;const t=new Array(this.entities.size);return this.entities.forEach((n=>{t[e]=n,e++})),{id:this.id,contextId:this.contextId,isFinal:this.isFinalized,words:this.words,entities:t,intent:this.intent}}toString(){const e=this.toSegment(),t=e.words.filter((e=>e.value)).map((e=>({value:e.value,index:e.index}))),n=Object.assign(Object.assign({},e),{words:t});return JSON.stringify(n,null,2)}updateTranscript(e){return e.forEach((e=>{this.isFinalized&&!e.isFinal||(this.words[e.index]=e)})),this}updateEntities(e){return e.forEach((e=>{this.isFinalized&&!e.isFinal||this.entities.set(function(e){return`${e.startPosition.toString()}:${e.endPosition.toString()}`}(e),e)})),this}updateIntent(e){return this.isFinalized&&!e.isFinal||(this.intent=e),this}finalize(){return this.entities.forEach(((e,t)=>{e.isFinal||this.entities.delete(t)})),this.words=this.words.filter((e=>e.isFinal)),this.intent.isFinal||(this.intent.intent="",this.intent.isFinal=!0),this.isFinalized=!0,this}};var Pn=Object.defineProperty({SegmentState:On},"__esModule",{value:!0});var Ln=function(e){return e.words.map((({word:e,index:t,start_timestamp:n,end_timestamp:a})=>({value:e,index:t,startTimestamp:n,endTimestamp:a,isFinal:!1})))};var Bn=function(e){return{value:e.word,index:e.index,startTimestamp:e.start_timestamp,endTimestamp:e.end_timestamp,isFinal:!0}};var Fn=function(e){return e.entities.map((({entity:e,value:t,start_position:n,end_position:a})=>({type:e,value:t,startPosition:n,endPosition:a,isFinal:!1})))};var Dn=function(e){return{type:e.entity,value:e.value,startPosition:e.start_position,endPosition:e.end_position,isFinal:!0}};var zn=function(e,t){return{intent:e.intent,isFinal:t}},$n=Object.defineProperty({parseTentativeTranscript:Ln,parseTranscript:Bn,parseTentativeEntities:Fn,parseEntity:Dn,parseIntent:zn},"__esModule",{value:!0});function jn(e,t){"boolean"==typeof t&&(t={forever:t}),this._originalTimeouts=JSON.parse(JSON.stringify(e)),this._timeouts=e,this._options=t||{},this._maxRetryTime=t&&t.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var Wn=jn;jn.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts},jn.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timeouts=[],this._cachedTimeouts=null},jn.prototype.retry=function(e){if(this._timeout&&clearTimeout(this._timeout),!e)return!1;var t=(new Date).getTime();if(e&&t-this._operationStart>=this._maxRetryTime)return this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(e);var n=this._timeouts.shift();if(void 0===n){if(!this._cachedTimeouts)return!1;this._errors.splice(this._errors.length-1,this._errors.length),this._timeouts=this._cachedTimeouts.slice(0),n=this._timeouts.shift()}var a=this,i=setTimeout((function(){a._attempts++,a._operationTimeoutCb&&(a._timeout=setTimeout((function(){a._operationTimeoutCb(a._attempts)}),a._operationTimeout),a._options.unref&&a._timeout.unref()),a._fn(a._attempts)}),n);return this._options.unref&&i.unref(),!0},jn.prototype.attempt=function(e,t){this._fn=e,t&&(t.timeout&&(this._operationTimeout=t.timeout),t.cb&&(this._operationTimeoutCb=t.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout((function(){n._operationTimeoutCb()}),n._operationTimeout)),this._operationStart=(new Date).getTime(),this._fn(this._attempts)},jn.prototype.try=function(e){console.log("Using RetryOperation.try() is deprecated"),this.attempt(e)},jn.prototype.start=function(e){console.log("Using RetryOperation.start() is deprecated"),this.attempt(e)},jn.prototype.start=jn.prototype.try,jn.prototype.errors=function(){return this._errors},jn.prototype.attempts=function(){return this._attempts},jn.prototype.mainError=function(){if(0===this._errors.length)return null;for(var e={},t=null,n=0,a=0;a<this._errors.length;a++){var i=this._errors[a],r=i.message,o=(e[r]||0)+1;e[r]=o,o>=n&&(t=i,n=o)}return t};var Un=ue((function(e,t){t.operation=function(e){var n=t.timeouts(e);return new Wn(n,{forever:e&&e.forever,unref:e&&e.unref,maxRetryTime:e&&e.maxRetryTime})},t.timeouts=function(e){if(e instanceof Array)return[].concat(e);var t={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var n in e)t[n]=e[n];if(t.minTimeout>t.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var a=[],i=0;i<t.retries;i++)a.push(this.createTimeout(i,t));return e&&e.forever&&!a.length&&a.push(this.createTimeout(i,t)),a.sort((function(e,t){return e-t})),a},t.createTimeout=function(e,t){var n=t.randomize?Math.random()+1:1,a=Math.round(n*t.minTimeout*Math.pow(t.factor,e));return a=Math.min(a,t.maxTimeout)},t.wrap=function(e,n,a){if(n instanceof Array&&(a=n,n=null),!a)for(var i in a=[],e)"function"==typeof e[i]&&a.push(i);for(var r=0;r<a.length;r++){var o=a[r],s=e[o];e[o]=function(a){var i=t.operation(n),r=Array.prototype.slice.call(arguments,1),o=r.pop();r.push((function(e){i.retry(e)||(e&&(arguments[0]=i.mainError()),o.apply(this,arguments))})),i.attempt((function(){a.apply(e,r)}))}.bind(e,s),e[o].options=n}}}));var Gn=function(e,t){return new Promise((function(n,a){var i=t||{};"randomize"in i||(i.randomize=!0);var r=Un.operation(i);function o(e){a(e||new Error("Aborted"))}function s(e,t){e.bail?o(e):r.retry(e)?i.onRetry&&i.onRetry(e,t):a(r.mainError())}r.attempt((function(t){var a;try{a=e(o,t)}catch(e){return void s(e,t)}Promise.resolve(a).then(n).catch((function(e){s(e,t)}))}))}))},Kn=ce(Pt),Vn=ce(on),Hn=le&&le.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(i,r){function o(e){try{l(a.next(e))}catch(e){r(e)}}function s(e){try{l(a.throw(e))}catch(e){r(e)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}l((a=a.apply(e,t||[])).next())}))},Jn=le&&le.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};const Zn=Jn(Kn),Xn=Jn(Gn),qn="speechly-auth-token";var Yn=class{constructor(e){var t,n,a,i,r,o,s,l,c,u,d,h;this.activeContexts=new Map,this.reconnectAttemptCount=5,this.reconnectMinDelay=1e3,this.contextStopDelay=250,this.state=de.ClientState.Disconnected,this.stateChangeCb=()=>{},this.segmentChangeCb=()=>{},this.tentativeTranscriptCb=()=>{},this.tentativeEntitiesCb=()=>{},this.tentativeIntentCb=()=>{},this.transcriptCb=()=>{},this.entityCb=()=>{},this.intentCb=()=>{},this.handleWebsocketResponse=e=>{var t;this.debug&&console.log("[SpeechlyClient]","Received response",e);const{audio_context:n,segment_id:a,type:i}=e;let{data:r}=e;const o=this.activeContexts.get(n);if(void 0===o)return void console.warn("[SpeechlyClient]","Received response for non-existent context",n);let s=null!==(t=o.get(a))&&void 0!==t?t:new Pn.SegmentState(n,a);switch(i){case An.WebsocketResponseType.TentativeTranscript:r=r;const e=$n.parseTentativeTranscript(r);this.tentativeTranscriptCb(n,a,e,r.transcript),s=s.updateTranscript(e);break;case An.WebsocketResponseType.Transcript:r=r;const t=$n.parseTranscript(r);this.transcriptCb(n,a,t),s=s.updateTranscript([t]);break;case An.WebsocketResponseType.TentativeEntities:r=r;const i=$n.parseTentativeEntities(r);this.tentativeEntitiesCb(n,a,i),s=s.updateEntities(i);break;case An.WebsocketResponseType.Entity:r=r;const o=$n.parseEntity(r);this.entityCb(n,a,o),s=s.updateEntities([o]);break;case An.WebsocketResponseType.TentativeIntent:r=r;const l=$n.parseIntent(r,!1);this.tentativeIntentCb(n,a,l),s=s.updateIntent(l);break;case An.WebsocketResponseType.Intent:r=r;const c=$n.parseIntent(r,!0);this.intentCb(n,a,c),s=s.updateIntent(c);break;case An.WebsocketResponseType.SegmentEnd:s=s.finalize()}o.set(a,s),this.activeContexts.set(n,o),this.logSegments&&console.info(s.toString()),this.segmentChangeCb(s.toSegment())},this.handleWebsocketClosure=e=>{this.debug&&console.error("[SpeechlyClient]","Server connection closed",e),void 0!==this.deviceId?this.state!==de.ClientState.Connecting&&this.state!==de.ClientState.Failed&&(this.setState(de.ClientState.Connecting),this.reconnectWebsocket(this.deviceId).then((()=>this.setState(de.ClientState.Connected))).catch((()=>this.setState(de.ClientState.Failed)))):this.setState(de.ClientState.Failed)},this.sampleRate=null!==(t=e.sampleRate)&&void 0!==t?t:Sn.DefaultSampleRate;try{const e=window.navigator.mediaDevices.getSupportedConstraints();this.nativeResamplingSupported=!0===e.sampleRate}catch(e){this.nativeResamplingSupported=!1}const m=null!==(n=e.language)&&void 0!==n?n:"en-US";if(!Zn.default.validate(m))throw Error(`[SpeechlyClient] Invalid language "${m}"`);this.debug=null!==(a=e.debug)&&void 0!==a&&a,this.logSegments=null!==(i=e.logSegments)&&void 0!==i&&i,this.loginUrl=null!==(r=e.loginUrl)&&void 0!==r?r:"https://api.speechly.com/login",this.appId=null!==(o=e.appId)&&void 0!==o?o:void 0,this.projectId=null!==(s=e.projectId)&&void 0!==s?s:void 0;const f=function(e,t,n){const a=new URLSearchParams;return a.append("languageCode",t),a.append("sampleRate",n.toString()),`${e}?${a.toString()}`}(null!==(l=e.apiUrl)&&void 0!==l?l:"wss://api.speechly.com/ws/v1",m,null!==(c=e.sampleRate)&&void 0!==c?c:Sn.DefaultSampleRate);this.apiClient=null!==(u=e.apiClient)&&void 0!==u?u:new An.WebWorkerController,this.storage=null!==(d=e.storage)&&void 0!==d?d:new Mn.LocalStorage,this.deviceId=this.storage.getOrSet("speechly-device-id",Vn.v4);const p=this.storage.get(qn);if(null!=p&&ln.validateToken(p,this.projectId,this.appId,this.deviceId)?(this.authToken=p,this.connect(f)):ln.fetchToken(this.loginUrl,this.projectId,this.appId,this.deviceId).then((e=>{this.authToken=e,this.storage.set(qn,this.authToken),this.connect(f)})).catch((e=>{throw e})),void 0!==window.AudioContext)this.isWebkit=!1;else{if(void 0===window.webkitAudioContext)throw Sn.ErrDeviceNotSupported;this.isWebkit=!0}this.microphone=null!==(h=e.microphone)&&void 0!==h?h:new Sn.BrowserMicrophone(this.isWebkit,this.sampleRate,this.apiClient),this.apiClient.onResponse(this.handleWebsocketResponse),this.apiClient.onClose(this.handleWebsocketClosure),window.SpeechlyClient=this}connect(e){this.apiClient.postMessage({type:"INIT",apiUrl:e,authToken:this.authToken,targetSampleRate:this.sampleRate})}initialize(){return Hn(this,void 0,void 0,(function*(){if(this.state!==de.ClientState.Disconnected)throw Error("Cannot initialize client - client is not in Disconnected state");this.setState(de.ClientState.Connecting);try{if(this.isWebkit)void 0!==window.webkitAudioContext&&(this.audioContext=new window.webkitAudioContext);else{const e={};this.nativeResamplingSupported&&(e.sampleRate=this.sampleRate),this.audioContext=new window.AudioContext(e)}const e={video:!1};if(this.nativeResamplingSupported?e.audio={sampleRate:this.sampleRate}:e.audio=!0,null==this.audioContext)throw Sn.ErrDeviceNotSupported;this.isWebkit&&(yield this.audioContext.resume()),yield this.apiClient.initialize(this.audioContext.sampleRate),this.initializeMicrophonePromise=this.microphone.initialize(this.audioContext,e),yield this.initializeMicrophonePromise}catch(e){switch(e){case Sn.ErrDeviceNotSupported:this.setState(de.ClientState.NoBrowserSupport);break;case Sn.ErrNoAudioConsent:this.setState(de.ClientState.NoAudioConsent);break;default:this.setState(de.ClientState.Failed)}throw e}this.setState(de.ClientState.Connected)}))}close(){return Hn(this,void 0,void 0,(function*(){const e=[];try{yield this.microphone.close()}catch(t){e.push(t.message)}try{yield this.apiClient.close()}catch(t){e.push(t.message)}if(this.activeContexts.clear(),this.setState(de.ClientState.Disconnected),e.length>0)throw Error(e.join(","))}))}switchContext(e){return Hn(this,void 0,void 0,(function*(){if(this.state===de.ClientState.Recording){this.resolveStopContext=void 0;const t=yield this.apiClient.switchContext(e);this.activeContexts.set(t,new Map)}}))}startContext(e){return Hn(this,void 0,void 0,(function*(){if(null!=this.resolveStopContext&&(this.resolveStopContext(),yield this.stoppedContextIdPromise),this.state===de.ClientState.Disconnected||this.state===de.ClientState.Connecting)throw Error("Cannot start context - client is not connected");this.setState(de.ClientState.Starting);return yield this._startContext(e)}))}_startContext(e){return Hn(this,void 0,void 0,(function*(){let t;try{t=null!=this.projectId?yield this.apiClient.startContext(e):yield this.apiClient.startContext()}catch(e){throw this.setState(de.ClientState.Connected),e}return this.setState(de.ClientState.Recording),this.microphone.unmute(),this.activeContexts.set(t,new Map),t}))}stopContext(){return Hn(this,void 0,void 0,(function*(){if(this.state!==de.ClientState.Recording&&this.state!==de.ClientState.Starting)throw Error("Cannot stop context - client is not recording");this.setState(de.ClientState.Stopping),this.stoppedContextIdPromise=new Promise((e=>{Promise.race([new Promise((e=>setTimeout(e,this.contextStopDelay))),new Promise((e=>{this.resolveStopContext=e}))]).then((()=>{this._stopContext().then((t=>{e(t)})).catch((e=>{throw e}))})).catch((e=>{throw e}))}));const e=yield this.stoppedContextIdPromise;return this.setState(de.ClientState.Connected),this.activeContexts.delete(e),e}))}_stopContext(){return Hn(this,void 0,void 0,(function*(){let e;this.microphone.mute();try{e=yield this.apiClient.stopContext()}catch(e){throw this.setState(de.ClientState.Failed),e}return e}))}onStateChange(e){this.stateChangeCb=e}onSegmentChange(e){this.segmentChangeCb=e}onTentativeTranscript(e){this.tentativeTranscriptCb=e}onTranscript(e){this.transcriptCb=e}onTentativeEntities(e){this.tentativeEntitiesCb=e}onEntity(e){this.entityCb=e}onTentativeIntent(e){this.tentativeIntentCb=e}onIntent(e){this.intentCb=e}reconnectWebsocket(e){return Hn(this,void 0,void 0,(function*(){return Xn.default(((e,t)=>Hn(this,void 0,void 0,(function*(){this.debug&&console.log("[SpeechlyClient]","WebSocket reconnection attempt number:",t)}))),{retries:this.reconnectAttemptCount,minTimeout:this.reconnectMinDelay})}))}setState(e){this.state!==e&&(this.debug&&console.log("[SpeechlyClient]","State transition",pe.stateToString(this.state),pe.stateToString(e)),this.state=e,this.stateChangeCb(e))}};var Qn=Object.defineProperty({Client:Yn},"__esModule",{value:!0}),ea=ue((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),function(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}(de),t.stateToString=pe.stateToString,t.Client=Qn.Client})),ta=ue((function(e,t){function n(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),n(ea),n(mn),n(bn),n(xn)}));function na(e){return function(t,n){if(!t.hasOwnProperty("ownerDocument")){Object.defineProperty(t,"ownerDocument",{get:function(){return t.parentElement}});let e=t;for(;e.parentElement;)e=e.parentElement;t.parentElement.head=e}return e(t,n)}}function aa(e){return e<.5?4*e*e*e:.5*Math.pow(2*e-2,3)+1}function ia(e,{delay:t=0,speed:n,duration:a,easing:i=aa}={}){const r=e.getTotalLength();return void 0===a?a=void 0===n?800:r/n:"function"==typeof a&&(a=a(r)),{delay:t,duration:a,easing:i,css:(e,t)=>`stroke-dasharray: ${e*r} ${t*r}`}}const ra=[0,1];function oa(e,t,n,a){if(t<n)return e[0];if(t>a)return e[e.length-1];let i=(a-n)/(e.length-1);if(i<=0)return e[0];let r=(t-n)/i,o=Math.floor(r),s=Math.ceil(r),l=r-o;return(1-l)*e[o]+l*e[s]}function sa(t){let n;return{c(){n=y("canvas"),this.c=e,k(n,"color",t[0])},m(e,a){v(e,n,a),t[2](n)},p(e,[t]){1&t&&k(n,"color",e[0])},i:e,o:e,d(e){e&&g(n),t[2](null)}}}function la(e,t,n){let a,{color:i="#60e0ff"}=t,r=0,o=0,s=[0,0];const l=O(),c=(e,t,n,a,i,r)=>{a<2*r&&(r=a/2),i<2*r&&(r=i/2),e.beginPath(),e.moveTo(t+r,n),e.arcTo(t+a,n,t+a,n+i,r),e.arcTo(t+a,n+i,t,n+i,r),e.arcTo(t,n+i,t,n,r),e.arcTo(t,n,t+a,n,r),e.closePath()};return P((()=>{let e;const t=2*(s.length-1)+1,i=3*t+1*(t-1),u=(e,t)=>{r=Date.now()>o?e:Math.max(r,e),o=Date.now()+t},d=()=>{if(e=requestAnimationFrame(d),!a)return;const t=a.getContext("2d");if(!t)return;let l=(e=>{var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t})(t),u=Number.parseInt(getComputedStyle(a).getPropertyValue("width").slice(0,-2)),h=Number.parseInt(getComputedStyle(a).getPropertyValue("height").slice(0,-2));n(1,a.width=u*l,a),n(1,a.height=h*l,a),Date.now()<o?s[0]=.15*r+.85*s[0]:s[0]=.0625+.75*s[0];let m=1;for(;m<s.length;)s[m]=.25*s[m-1]+.5*s[m]+.0625,m++;t.clearRect(0,0,a.width,a.height);const f=3/i*a.width*.5,p=4/i*a.width;for(t.fillStyle=a.style.color||"#000000",m=0;m<s.length;m++){const e=s[m]*a.height;e*a.height>2*f?c(t,.5*a.width-f+m*p,.5*(a.height-e),2*f,e,f):(t.beginPath(),t.arc(.5*a.width+m*p,.5*a.height,e*a.height*.5,0,2*Math.PI)),t.fill(),m>0&&(e*a.height>2*f?c(t,.5*a.width-f-m*p,.5*(a.height-e),2*f,e,f):(t.beginPath(),t.arc(.5*a.width-m*p,.5*a.height,e*a.height*.5,0,2*Math.PI)),t.fill())}};d(),u(1,350);const h=e=>u(.5*Math.random()+.5,75*Math.random()+75);return l.addEventListener("updateVU",h),()=>{cancelAnimationFrame(e),l.removeEventListener("updateVU",h)}})),e.$$set=e=>{"color"in e&&n(0,i=e.color)},[i,a,function(e){B[e?"unshift":"push"]((()=>{a=e,n(1,a)}))}]}customElements.define("vu-meter",class extends se{constructor(e){super(),this.shadowRoot.innerHTML="<style>canvas{display:block;width:1.35rem;height:1.5rem;margin:0;padding:0 0.8rem 0 0rem}</style>",oe(this,{target:this.shadowRoot,props:A(this.attributes),customElement:!0},la,sa,o,{color:0}),e&&(e.target&&v(e.target,this,e.anchor),e.props&&(this.$set(e.props),G()))}static get observedAttributes(){return["color"]}get color(){return this.$$.ctx[0]}set color(e){this.$set({color:e}),G()}});const{window:ca}=ie;function ua(e,t,n){const a=e.slice();return a[27]=t[n],a[29]=n,a}function da(e){let t,n,a,i,r,o,s=!e[11]&&ha(e),l=e[6],c=[];for(let t=0;t<l.length;t+=1)c[t]=pa(ua(e,l,t));let u=e[10]&&va(e);return{c(){t=y("div"),s&&s.c(),n=w();for(let e=0;e<c.length;e+=1)c[e].c();a=w(),u&&u.c(),C(t,"class","BigTranscript")},m(e,i){v(e,t,i),s&&s.m(t,null),p(t,n);for(let e=0;e<c.length;e+=1)c[e].m(t,null);p(t,a),u&&u.m(t,null),o=!0},p(e,i){if(e[11]?s&&(q(),ee(s,1,1,(()=>{s=null})),Y()):s?(s.p(e,i),2048&i&&Q(s,1)):(s=ha(e),s.c(),Q(s,1),s.m(t,n)),132160&i){let n;for(l=e[6],n=0;n<l.length;n+=1){const r=ua(e,l,n);c[n]?(c[n].p(r,i),Q(c[n],1)):(c[n]=pa(r),c[n].c(),Q(c[n],1),c[n].m(t,a))}for(;n<c.length;n+=1)c[n].d(1);c.length=l.length}e[10]?u?(u.p(e,i),1024&i&&Q(u,1)):(u=va(e),u.c(),Q(u,1),u.m(t,null)):u&&(u.d(1),u=null)},i(n){if(!o){Q(s);for(let e=0;e<l.length;e+=1)Q(c[e]);Q(u),j((()=>{r&&r.end(1),i||(i=ne(t,e[14],{})),i.start()})),o=!0}},o(n){ee(s),i&&i.invalidate(),r=ae(t,e[14],{}),o=!1},d(e){e&&g(t),s&&s.d(),function(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}(c,e),u&&u.d(),e&&r&&r.end()}}}function ha(e){let t,n,a,i,r,o,s,l,c,u=e[12]&&ma(e);return{c(){t=y("div"),n=y("div"),a=w(),i=y("div"),r=y("vu-meter"),o=w(),u&&u.c(),C(n,"class","TransscriptItemBgDiv"),N(r,"color",e[4]),C(i,"class","TransscriptItemContent"),C(t,"class","TranscriptItem")},m(s,l){v(s,t,l),p(t,n),p(t,a),p(t,i),p(i,r),e[19](r),p(i,o),u&&u.m(i,null),c=!0},p(e,t){(!c||16&t)&&N(r,"color",e[4]),e[12]?u?4096&t&&Q(u,1):(u=ma(e),u.c(),Q(u,1),u.m(i,null)):u&&(q(),ee(u,1,1,(()=>{u=null})),Y())},i(n){c||(Q(u),j((()=>{l&&l.end(1),s||(s=ne(t,e[15],{duration:200})),s.start()})),c=!0)},o(n){ee(u),s&&s.invalidate(),l=ae(t,e[15],{duration:200,maxWidth:3}),c=!1},d(n){n&&g(t),e[19](null),u&&u.d(),n&&l&&l.end()}}}function ma(e){let t,n,a,i;return{c(){t=y("div"),t.textContent="Listening...",C(t,"class","listening")},m(e,n){v(e,t,n),i=!0},i(r){i||(j((()=>{a&&a.end(1),n||(n=ne(t,e[15],{duration:400})),n.start()})),i=!0)},o(r){n&&n.invalidate(),a=ae(t,e[15],{duration:200}),i=!1},d(e){e&&g(t),e&&a&&a.end()}}}function fa(e){let t,n;return{c(){t=y("span"),C(t,"style",n=e[29]<e[6].length-1?"width:0.25em;":e[10]?"width:1.2em;":"")},m(e,n){v(e,t,n)},p(e,a){1088&a&&n!==(n=e[29]<e[6].length-1?"width:0.25em;":e[10]?"width:1.2em;":"")&&C(t,"style",n)},d(e){e&&g(t)}}}function pa(t){let n,a,i,r,o,s,l,c,u,d=t[27].word+"",h=t[29]<t[6].length&&fa(t);return{c(){n=y("div"),a=y("div"),r=w(),o=y("div"),s=b(d),l=w(),h&&h.c(),C(a,"class","TransscriptItemBgDiv"),C(o,"class","TransscriptItemContent"),C(n,"class",u="TranscriptItem "+t[17](t[27])),T(n,"Entity",null!==t[27].entityType),T(n,"Final",t[27].isFinal)},m(e,t){v(e,n,t),p(n,a),p(n,r),p(n,o),p(o,s),p(o,l),h&&h.m(o,null)},p(e,t){64&t&&d!==(d=e[27].word+"")&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(s,d),e[29]<e[6].length?h?h.p(e,t):(h=fa(e),h.c(),h.m(o,null)):h&&(h.d(1),h=null),64&t&&u!==(u="TranscriptItem "+e[17](e[27]))&&C(n,"class",u),64&t&&T(n,"Entity",null!==e[27].entityType),64&t&&T(n,"Final",e[27].isFinal)},i(e){i||j((()=>{i=ne(a,t[15],{}),i.start()})),c||j((()=>{c=ne(o,t[15],{}),c.start()}))},o:e,d(e){e&&g(n),h&&h.d()}}}function va(t){let n,a,i,r,o,s,l,c;return{c(){n=y("div"),a=y("div"),i=w(),r=y("div"),o=S("svg"),s=S("path"),C(a,"class","TransscriptItemBgDiv"),k(a,"background-color",t[4]),C(s,"stroke","currentColor"),C(s,"stroke-width","3"),C(s,"d","M7.191 11.444l4.059 6.107 7.376-12.949"),C(s,"fill","none"),C(s,"fill-rule","evenodd"),k(o,"width","2rem"),k(o,"height","2rem"),k(o,"position","absolute"),k(o,"transform","translate(-0.5rem, -0.5rem)"),k(o,"stroke","#eee"),C(o,"viewBox","0 0 24 24"),C(o,"xmlns","http://www.w3.org/2000/svg"),k(r,"width","1.0rem"),k(r,"height","1rem"),k(r,"position","relative"),C(n,"class","TranscriptItem")},m(e,t){v(e,n,t),p(n,a),p(n,i),p(n,r),p(r,o),p(o,s)},p(e,t){16&t&&k(a,"background-color",e[4])},i(e){l||j((()=>{l=ne(s,t[13],{duration:500}),l.start()})),c||j((()=>{c=ne(n,t[15],{duration:200,maxWidth:3}),c.start()}))},o:e,d(e){e&&g(n)}}}function ga(t){let n,a,i,r,o,s,l=(t[7]===ta.ClientState.Recording||t[9])&&da(t);return{c(){n=y("main"),l&&l.c(),a=w(),i=y("link"),this.c=e,k(n,"--voffset",t[1]),k(n,"--hoffset",t[2]),k(n,"--fontsize",t[3]),k(n,"--highlight-color",t[4]),k(n,"--text-bg-color",t[5]),T(n,"placementTop","top"===t[0]),C(i,"href","https://fonts.googleapis.com/css2?family=Saira+Condensed:wght@700&display=swap"),C(i,"rel","stylesheet")},m(e,c){var u,d,h,m;v(e,n,c),l&&l.m(n,null),v(e,a,c),p(document.head,i),r=!0,o||(u=ca,d="message",h=t[16],u.addEventListener(d,h,m),s=()=>u.removeEventListener(d,h,m),o=!0)},p(e,[t]){e[7]===ta.ClientState.Recording||e[9]?l?(l.p(e,t),640&t&&Q(l,1)):(l=da(e),l.c(),Q(l,1),l.m(n,null)):l&&(q(),ee(l,1,1,(()=>{l=null})),Y()),(!r||2&t)&&k(n,"--voffset",e[1]),(!r||4&t)&&k(n,"--hoffset",e[2]),(!r||8&t)&&k(n,"--fontsize",e[3]),(!r||16&t)&&k(n,"--highlight-color",e[4]),(!r||32&t)&&k(n,"--text-bg-color",e[5]),1&t&&T(n,"placementTop","top"===e[0])},i(e){r||(Q(l),r=!0)},o(e){ee(l),r=!1},d(e){e&&g(n),l&&l.d(),e&&g(a),g(i),o=!1,s()}}}function ya(e,t,n){let a,i,{placement:r}=t,{voffset:o="3rem"}=t,{hoffset:s="2rem"}=t,{fontsize:l="1.5rem"}=t,{highlightcolor:c="#15e8b5"}=t,{textbgcolor:u="#202020"}=t,d=[],h=!1,m=!1,f=null,p=ta.ClientState.Disconnected,v=!1,g=!0;const y=O(),S=na(ia),b=na(((e,{delay:t=0,duration:n=400})=>({delay:t,duration:n,easing:aa,css:e=>`\n        opacity: ${oa(ra,e,0,1)};\n        max-height: ${10*oa(ra,e,0,.6)}rem;\n        margin-bottom: ${1.5*oa(ra,e,0,.6)}rem;\n      `}))),w=na(((e,{delay:t=0,duration:n=350,maxWidth:a=10})=>({delay:t,duration:n,css:e=>`\n        max-width: ${oa(ra,e,0,1)*a}rem;\n      `}))),C=e=>{void 0!==e&&(i&&m&&i.dispatchEvent(new CustomEvent("updateVU",{detail:{level:1,seekTimeMs:1e3}})),e.isFinal?(n(11,g=!0),k(d.length>0?2e3:0)):d.length>0&&(n(9,h=!0),k(2e3)),n(6,d=[]),e.words.forEach((e=>{n(6,d[e.index]={word:e.value,serialNumber:e.index,entityType:null,isFinal:e.isFinal,hide:!1},d)})),e.entities.forEach((e=>{n(6,d[e.startPosition].word=e.value,d),n(6,d[e.startPosition].entityType=e.type,d),n(6,d[e.startPosition].isFinal=e.isFinal,d),n(6,d[e.startPosition].hide=!1,d);for(let t=e.startPosition+1;t<e.endPosition;t++)d[t]&&n(6,d[t].hide=!0,d)})),n(6,d=d.filter((e=>!e.hide))))};y.onSegmentUpdate=C;const N=e=>{var t,n;t="debug",n="big-transcript.ping 1",y.dispatchEvent(new CustomEvent(t,{detail:n,composed:!0}))},k=(e=0)=>{T(),f=window.setTimeout((()=>{n(9,h=!1),f=null}),e)},T=()=>{null!==f&&(window.clearTimeout(f),f=null)};return P((()=>{const e=e=>C(e.detail);return y.addEventListener("speechsegment",e),y.addEventListener("ping",N),()=>{cancelAnimationFrame(null),y.removeEventListener("speechsegment",e),y.removeEventListener("ping",N)}})),e.$$set=e=>{"placement"in e&&n(0,r=e.placement),"voffset"in e&&n(1,o=e.voffset),"hoffset"in e&&n(2,s=e.hoffset),"fontsize"in e&&n(3,l=e.fontsize),"highlightcolor"in e&&n(4,c=e.highlightcolor),"textbgcolor"in e&&n(5,u=e.textbgcolor)},e.$$.update=()=>{262336&e.$$.dirty&&n(12,a=0===d.length&&m&&p===ta.ClientState.Recording)},[r,o,s,l,c,u,d,p,i,h,v,g,a,S,b,w,e=>{switch(e.data.type){case"speechsegment":C(e.data.segment);break;case"holdstart":n(18,m=!0);break;case"holdend":n(18,m=!1);break;case"speechhandled":e.data.success&&n(10,v=!0);break;case"speechstate":n(7,p=e.data.state),p===ta.ClientState.Recording&&(n(10,v=!1),n(11,g=!1),n(6,d=[]))}},e=>e.entityType||"",m,function(e){B[e?"unshift":"push"]((()=>{i=e,n(8,i)}))}]}customElements.define("big-transcript",class extends se{constructor(e){super(),this.shadowRoot.innerHTML="<style>.BigTranscript{position:relative;user-select:none;font-family:'Saira Condensed', sans-serif;text-transform:uppercase;color:#fff;font-size:var(--fontsize);line-height:135%;margin-bottom:1.5rem;display:flex;flex-direction:row;justify-content:start;flex-wrap:wrap}.TranscriptItem{position:relative;display:flex;flex-direction:row;align-items:center}.Entity{color:var(--highlight-color)}.TransscriptItemContent{z-index:1;display:flex;flex-wrap:nowrap;flex-direction:row;align-items:center;overflow:hidden}.TransscriptItemBgDiv{position:absolute;box-sizing:content-box;width:100%;height:100%;top:-0.2rem;left:-0.8rem;margin:0;padding:0.2rem 0.8rem;background-color:var(--text-bg-color);z-index:-1}.placementTop{position:fixed;top:0;left:0;right:0;bottom:0;margin:var(--voffset) var(--hoffset) 0 var(--hoffset);z-index:50;pointer-events:none}.listening{animation:flow 1s linear infinite;background:linear-gradient(-60deg, #fff8, #fffc, #fff8, #fffc, #fff8);background-size:200%;-webkit-background-clip:text;background-clip:text;-webkit-text-fill-color:transparent;-webkit-box-decoration-break:clone}@keyframes flow{0%{background-position:0 50%}100%{background-position:100% 50%}}</style>",oe(this,{target:this.shadowRoot,props:A(this.attributes),customElement:!0},ya,ga,o,{placement:0,voffset:1,hoffset:2,fontsize:3,highlightcolor:4,textbgcolor:5}),e&&(e.target&&v(e.target,this,e.anchor),e.props&&(this.$set(e.props),G()))}static get observedAttributes(){return["placement","voffset","hoffset","fontsize","highlightcolor","textbgcolor"]}get placement(){return this.$$.ctx[0]}set placement(e){this.$set({placement:e}),G()}get voffset(){return this.$$.ctx[1]}set voffset(e){this.$set({voffset:e}),G()}get hoffset(){return this.$$.ctx[2]}set hoffset(e){this.$set({hoffset:e}),G()}get fontsize(){return this.$$.ctx[3]}set fontsize(e){this.$set({fontsize:e}),G()}get highlightcolor(){return this.$$.ctx[4]}set highlightcolor(e){this.$set({highlightcolor:e}),G()}get textbgcolor(){return this.$$.ctx[5]}set textbgcolor(e){this.$set({textbgcolor:e}),G()}})}();
//# sourceMappingURL=big-transcript.js.map
